<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 3.9.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.zdaiot.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="本文主要参考了实时目标检测：YOLO、YOLOv2以及YOLOv3以及Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3。 You only look once（YOLO）是一系列用于解决实时目标检测问题的算法。在本文中，将依次介绍YOLO、YOLOv2以及YOLOv3。在YOLO的官方网站上，作者提供了一些目标检测算法的性能和速"><meta name="keywords" content="目标检测,YOLO"><meta property="og:type" content="article"><meta property="og:title" content="实时目标检测：YOLO、YOLOv2以及YOLOv3"><meta property="og:url" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/index.html"><meta property="og:site_name" content="zdaiot"><meta property="og:description" content="本文主要参考了实时目标检测：YOLO、YOLOv2以及YOLOv3以及Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3。 You only look once（YOLO）是一系列用于解决实时目标检测问题的算法。在本文中，将依次介绍YOLO、YOLOv2以及YOLOv3。在YOLO的官方网站上，作者提供了一些目标检测算法的性能和速"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/image-20200401101101061.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_EYFejGUjvjPcc4PZTwoufw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QOGcvHbrDZiCqTG6THIQ_w.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-1a6f0fc27b69040b0c16ca480444edf8_720w.jpg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-657d39aaeb56bf586cb18f733244c8e6_720w.jpg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_6qZXYCDUkC5Bc8nRolT0Mw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_4Y1PaY3ZgxKt5w84_0pNxw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_j4PnWfxP3yoVPOFyI27tww.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_OuMJUWo2rXYA-GYU63NUGw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_jtnrhMFNwGxiQmkY6LkdCQ.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-33df11dea3ad6ba31fccb709f26fc1d3_720w.jpg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_e0VY6U1_WMF2KBoKQNZvkQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_qVL77IZyEnra4DvENayXUA.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0IPktA65WxOBfP_ULQWcmw.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_9ER4GVUtQGVA2Y0skC9OQQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-ccdd48a4323783358a0cd31dbf86b52a_720w.jpg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_lF6SCAVj5jMwLxs39SCogw.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-ac13ab74095659e153c79da27052f923_720w.jpg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_BwhGMvffFfqtND9413oiwA.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QT7mwEbyLJYIxTYtOWClFQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_Yc_OJIXOoV2WaGQ6PqhTXA.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_aW6htqx4Q7APLrSQg2eWDw.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_XbOnbcZmc50hyhhTwhD5QA-1585712286935.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_7iwTsezrn-tSndx96twprA.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_krGqonOLMzSE_PWqH_LvQA.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_CGWTPTY0sfvQoxsS0X6VFg.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_8Q8r9ixjTiKLi1mrF36xCw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_tavjieD0Bum_uX-svYUTKA.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_UsqjfoW3sLkmyXKQ0Hyo8A.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_KiSd2CBfcs5af6oliHCqzw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_89qezEeLKJLpD8_fM_H4qQ.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_esSmI0UaMr-GrqkUGMg0hA.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_l5wvrPjLlFp6Whgy0MqbKQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_38-Tdx-wQA7c3TX5hdnwpw.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_gyOSRA_FDz4Pf5njoUb4KQ.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_RuW-SCIML8SHc5_PrIE9-g.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_3IdCKSzR5R0lIE1LSmN4Bg.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_NJj17Z6FgffYaA4WH2WIjw.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_8FiQUakp9i4MneU4VXk4Ww.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_NBnDpz8fitkhcdnkgF2bvg.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QKwSclDLcT8eJxyj3CVL0w.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_TALo1-LuWbF80RTCM7bszw.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0Oyd6FWXo7OJzzuXuXSoDQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1__gX42bmgvyib4lyR9GQrAg.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1__0ijX5oRZdQCNlSk-gXj3Q.jpeg"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0XHKAh0GxpW22y1DlL4hYA.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_UuIx6sH39tefFMxgWAaaNQ.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_biRYJyCSv-UTbTQTa4Afqg-1585798541494.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_bFMwN__ZgfvVRYuo4o8EEg-1585798627659.png"><meta property="og:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_RFpjH8D6TStBaYuZYehe_g-1585798641298.png"><meta property="og:updated_time" content="2020-04-01T02:08:08.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="实时目标检测：YOLO、YOLOv2以及YOLOv3"><meta name="twitter:description" content="本文主要参考了实时目标检测：YOLO、YOLOv2以及YOLOv3以及Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3。 You only look once（YOLO）是一系列用于解决实时目标检测问题的算法。在本文中，将依次介绍YOLO、YOLOv2以及YOLOv3。在YOLO的官方网站上，作者提供了一些目标检测算法的性能和速"><meta name="twitter:image" content="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/image-20200401101101061.png"><link rel="canonical" href="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>实时目标检测：YOLO、YOLOv2以及YOLOv3 | zdaiot</title><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0b0b58037319da4959d5a3c014160ccd";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">zdaiot</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">404NotFound</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="zdaiot"><meta itemprop="description" content="404NotFound"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="zdaiot"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 实时目标检测：YOLO、YOLOv2以及YOLOv3<a href="https://github.com/zdaiot/zdaiot.github.io/tree/hexo/source/_posts/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pencil-alt"></i></a></h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-04-01 10:08:08" itemprop="dateCreated datePublished" datetime="2020-04-01T10:08:08+08:00">2020-04-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DeepLearningApplications/" itemprop="url" rel="index"><span itemprop="name">DeepLearningApplications</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/DeepLearningApplications/目标检测/" itemprop="url" rel="index"><span itemprop="name">目标检测</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>14k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>13 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p>本文主要参考了<a href="http://activepony.com/shen-du-xue-xi/mu-biao-jian-ce/yolo-xi-lie-jie-du/" target="_blank" rel="noopener">实时目标检测：YOLO、YOLOv2以及YOLOv3</a>以及<a href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088" target="_blank" rel="noopener">Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3</a>。</p><p>You only look once（YOLO）是一系列用于解决实时目标检测问题的算法。在本文中，将依次介绍YOLO、YOLOv2以及YOLOv3。在YOLO的<a href="https://pjreddie.com/darknet/yolo/" target="_blank" rel="noopener">官方网站</a>上，作者提供了一些目标检测算法的性能和速度的对比，如下图所示。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/image-20200401101101061.png" alt="image-20200401101101061"></p><p>在本文中，将以下述图片为例进行算法的讲解。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_EYFejGUjvjPcc4PZTwoufw.jpeg" alt="img" style="zoom:67%"></p><p>YOLO检测结果：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QOGcvHbrDZiCqTG6THIQ_w.png" alt="img" style="zoom:67%"></p><h2 id="滑动窗口与CNN"><a href="#滑动窗口与CNN" class="headerlink" title="滑动窗口与CNN"></a>滑动窗口与CNN</h2><p>在介绍Yolo算法之前，首先先介绍一下滑动窗口技术，这对我们理解Yolo算法是有帮助的。采用滑动窗口的目标检测算法思路非常简单，它将检测问题转化为了图像分类问题。其基本原理就是<strong>采用不同大小和比例（宽高比）的窗口在整张图片上以一定的步长进行滑动，然后对这些窗口对应的区域做图像分类，这样就可以实现对整张图片的检测了，</strong>如下图所示，如DPM就是采用这种思路。但是这个方法有致命的缺点，就是你并不知道要检测的目标大小是什么规模，所以你要设置不同大小和比例的窗口去滑动，而且还要选取合适的步长。但是这样会产生很多的子区域，并且都要经过分类器去做预测，这需要很大的计算量，所以你的分类器不能太复杂，因为要保证速度。解决思路之一就是减少要分类的子区域，这就是R-CNN的一个改进策略，其采用了selective search方法来找到最有可能包含目标的子区域（Region Proposal），其实可以看成采用启发式方法过滤掉很多子区域，这会提升效率。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-1a6f0fc27b69040b0c16ca480444edf8_720w.jpg" alt="img"></p><p>如果你使用的是CNN分类器，那么滑动窗口然后输入到CNN分类器是非常耗时的。但是结合卷积运算的特点，我们可以使用CNN实现更高效的滑动窗口方法。这里要介绍的是一种全卷积（网络中用卷积层代替了全连接层）的方法，如下图所示。输入图片大小是16x16，经过一系列卷积操作，提取了2x2的特征图，但是这个2x2的图上每个元素都是和原图是一一对应的，如图上蓝色的格子对应蓝色的区域，这不就是相当于在原图上做大小为14x14的窗口滑动，且步长为2，共产生4个子区域。最终输出的通道数为4，可以看成4个类别的预测概率值，这样<strong>一次CNN计算就可以实现窗口滑动的所有子区域的分类预测</strong>。这其实是overfeat算法的思路。之所可以CNN可以实现这样的效果是因为卷积操作的特性，就是<strong>图片的空间位置信息的不变性</strong>，尽管卷积过程中图片大小减少，但是<strong>位置对应关系还是保存的</strong>。说点题外话，这个思路也被R-CNN借鉴，从而诞生了Fast R-cNN算法。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-657d39aaeb56bf586cb18f733244c8e6_720w.jpg" alt="img"></p><p>上面尽管可以减少滑动窗口的计算量，但是只是针对一个固定大小与步长的窗口，这是远远不够的。Yolo算法很好的解决了这个问题，它不再是窗口滑动了，而是直接将原始图片分割成互不重合的小方块，然后通过卷积最后生产这样大小的特征图，基于上面的分析，可以认为特征图的每个元素也是对应原始图片的一个小方块，然后用每个元素来可以预测那些中心点在该小方格内的目标，这就是Yolo算法的朴素思想。下面将详细介绍Yolo算法的设计理念。</p><h2 id="Grid-cell"><a href="#Grid-cell" class="headerlink" title="Grid cell"></a>Grid cell</h2><p>为了方便讨论，我们裁减了原始图片。YOLO将输入图像划分为了$S\times S$个Grid。<strong>每一个grid cell只预测一个物体。</strong>例如，“person”（蓝色框）的<strong>中心</strong>（蓝色点）落在了黄色grid cell内，因而黄色grid cell负责对person进行预测。</p><p>关于“物体落在哪个cell，哪个cell就负责预测这个物体”要分两个阶段来看，包括训练和测试：</p><ol><li>训练阶段：如果物体<strong>中心</strong>落在这个cell，那么就给这个cell打上这个物体的label（包括边界框坐标和类别）。<strong>也就是说我们是通过这种方式来设置训练过程中的truth label的。</strong>换言之，我们在训练阶段，就教会cell要预测图像中的哪个物体。</li><li>测试阶段：因为在训练阶段已经教会了cell去预测中心落在该cell中的物体，那么cell自然也会这么做。</li></ol><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_6qZXYCDUkC5Bc8nRolT0Mw.jpeg" alt="img" style="zoom:67%"></p><p>每一个grid cell预测固定数量的<strong>边界框（boundary boxes）</strong>。在本例中，黄色的grid cell预测出两个边界框（蓝色的框）去定位人在哪。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_4Y1PaY3ZgxKt5w84_0pNxw.jpeg" alt="img"></p><p>但是，一个框只能预测一个目标的设定限制了所能预测的目标之间的距离，例如当有多个目标的中心落在同一个grid cell中时，YOLO只会负责预测其中的一个目标。如下图所示，在左下角有9个圣诞老人，而YOLO只能检测出5个。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_j4PnWfxP3yoVPOFyI27tww.jpeg" alt="img" style="zoom:25%"></p><p>对于每一个Grid cell：</p><ul><li>预测$B$个边界框，每一个边界框有一个box置信度分数；</li><li>不管边界框的数目$B$有多少个，都只预测一个目标；</li><li>预测$C$个条件类别概率（目标属于各个类别的条件概率）</li></ul><p>为了评估PASCAL VOC，YOLO使用$7 \times 7$个grids（$S=7$），2个边界框（$B$），20个类别（$C$）。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_OuMJUWo2rXYA-GYU63NUGw.jpeg" alt="img" style="zoom:50%"></p><p>每一个边界框包含5个元素：$(x,y,w,h)$以及边界框置信度分数（box confidence score）。置信度分数表明了当前边界框包含目标的置信度和边界框的准确度。</p><p>对于边界框，使用图片的宽和高对其宽$w$和高$h$进行归一化。$x,y$的值为相对于当前cell左上角的偏移量，并且单位是相对于单元格大小的。因而$(x,y,w,h)$的值都被限定在$[0,1]$之间。每一个cell都有20个类别条件概率。类别条件概率是检测出的物体属于特定类的概率。所以YOLO预测的形状为$(S,S,B\times 5+C)=(7,7,2\times 5+20)=(7,7,30)$。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_jtnrhMFNwGxiQmkY6LkdCQ.jpeg" alt="img"></p><p>这里需要重点理解输入和输出的映射关系，如下图所示，输入图像左上角的网格对应到输出张量中左上角的向量。。要注意的是，并不是说仅仅网格内的信息被映射到一个30维向量。经过神经网络对输入图像信息的提取和变换，网格周边的信息也会被识别和整理，最后编码到那个30维向量中。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-33df11dea3ad6ba31fccb709f26fc1d3_720w.jpg" alt="img"></p><p>YOLO的核心思想就是使用一个卷积神经网络来预测一个大小为$(7,7,30)$的张量。首先，YOLO使用CNN来将特征图的空间大小降低为$7×7$，在特征图中的每一点处都有1024个通道；接着，YOLO使用两层全连接层来执行线性回归操作，最终的到$7×7×2$个边界框的预测（中间图片所示）。为了进行最终的预测，算法会将置信度分数大于阈值（大于0.25）的预测框留下，作为最终的预测（右侧图片所示）。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_e0VY6U1_WMF2KBoKQNZvkQ.png" alt="img" style="zoom:67%"></p><p>图中所预测出的每一个边界框的<strong>类别置信度分数</strong>的计算公式如下：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_qVL77IZyEnra4DvENayXUA.png" alt="img"></p><p>该分数同时对分类和定位（目标处在何处）的置信度进行度量。</p><p>我们很容易混淆那些得分和概率术语。以下是数学定义，供您参考。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0IPktA65WxOBfP_ULQWcmw.png" alt="img"></p><h2 id="网络设计"><a href="#网络设计" class="headerlink" title="网络设计"></a>网络设计</h2><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_9ER4GVUtQGVA2Y0skC9OQQ.png" alt="img"></p><p>YOLO的网络结构由24个卷积层加2个全连接层构成。在一些卷积层，交替使用$1\times 1$大小的卷积核来降低特征图的深度。最后一层卷积层的输出特征图大小为$(7,7,1024)$。然后tensor被flattened。使用两个全连接层来进行线性回归，最终输出大小为$7\times 7\times 30$，接着reshape成$(7,7,30)$。即两个边界框预测每个定位。最后一个输出的含义如下所示：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-ccdd48a4323783358a0cd31dbf86b52a_720w.jpg" alt="img" style="zoom:80%"></p><p>也就是说，每个cell有两个predictor，每个predictor分别预测一个bounding box的xywh和相应的confidence。但<strong>分类部分的预测却是共享的。正因为这个，同个cell是没办法预测多个目标的。</strong></p><p>现在考虑两个问题：</p><ol><li><p>假设类别预测不是共享的，cell中两个predictor都有各自的类别预测，这样能否在一个cell中预测两个目标？</p><p>答：否定的。如果一个cell要预测两个目标，那么这两个predictor要怎么分工预测这两个目标？谁负责谁？不知道，所以没办法预测。而像faster rcnn这类算法，可以根据anchor与ground truth的IOU大小来安排anchor负责预测哪个物体，也就是说，anchor机制的好处是在训练过程中正负样本的确定是稳定的，</p><p>而YOLO这种采用预测出的box与gt匹配确定正负样本的方案，导致训练过程中正负样本可能会不断变化。若非要一个cell中预测两个目标，可能导致前面Predictor A还在朝着Ground Truth Box A 优化loss function，后面如果又要求其Ground Truth Box B优化loss function，不断调整更新的方向极易造成收敛问题，至少也有延长了收敛时间的问题。。所以后来yolo2也采用了anchor思想，同个cell才能预测多个目标。<strong>所以对于YOLO而言，一张图片最多检测出49个图像。</strong></p></li><li><p>为什么要预测两个bounding box？</p><p>答：既然我们一个cell只能预测一个目标，为什么还要预测两个bounding box（或者更多）？这个还是要从训练阶段怎么给两个predictor安排训练目标来说。在训练的时候会在线地计算每个predictor预测的bounding box和ground truth的IOU，计算出来的IOU大的那个predictor，就会负责预测这个物体，另外一个则不预测。这么做有什么好处？我的理解是，这样做的话，实际上有两个predictor来一起进行预测，然后网络会在线选择预测得好的那个predictor（也就是IOU大）来进行预测。通俗一点说，就是我找一堆人来并行地干一件事，然后我选干的最好的那个。训练开始阶段，网络预测的bounding box可能都是乱来的，但总是选择IOU相对好一些的那个，随着训练的进行，每个bounding box会逐渐擅长对某些情况的预测（可能是对象大小、宽高比、不同类型的对象等）。所以，这是一种进化或者非监督学习的思想。</p></li><li><p>YOLO的bounding box并不是Faster RCNN的Anchor</p><p>Faster RCNN等一些算法采用每个grid中手工设置n个Anchor（先验框，预先设置好位置的bounding box）的设计，每个Anchor有不同的大小和宽高比。YOLO的bounding box看起来很像一个grid中2个Anchor，但它们不是。YOLO并没有预先设置2个bounding box的大小和形状，也没有对每个bounding box分别输出一个对象的预测。它的意思仅仅是对一个对象预测出2个bounding box，选择预测得相对比较准的那个。</p></li></ol><p>YOLO还有一个快速但低精度的版本，被称为Fast YOLO，只使用了9个卷积层。</p><h2 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h2><p>对于每一个grid cell，YOLO会预测多个边界框。为了计算true positive的损失，我们只希望这些边界框中的一个来负责预测对应的目标。为此，我们选中这些边界框中与ground truth有着最大IoU的那个。这一策略使得在进行预测时，边界框变得专一化。每一个预测都擅长于预测特定的大小和长宽比的目标。</p><p>YOLO使用预测和ground truth之间的均方误差来计算损失，损失函数包含以下几部分：</p><ul><li>分类损失</li><li>定位损失（预测的边界框和ground truth之间的误差）</li><li>置信度损失（边界框是否包含目标）</li></ul><h3 id="分类损失"><a href="#分类损失" class="headerlink" title="分类损失"></a>分类损失</h3><p>当grid cell中有实际目标中心点落入时（即下面公式中$\mathbb {1_{ij}^{obj}}$的含义），则计算分类损失。每一个cell的分类误差的计算方式为：每一类的<strong>类条件概率</strong>的均方误差。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_lF6SCAVj5jMwLxs39SCogw.png" alt="img"></p><p>这里详细说明一下，物体类别是一个<strong>条件概率</strong>$P_r(Class_i/Object)$（意思是如果该网格存在一个对象Object，那么它是$C_i$类的概率）。这个可以分两个阶段理解：</p><ol><li><p>对于训练阶段，也就是打label阶段，怎么打label呢？对于一个cell，如果物体的中心落在了这个cell，那么我们给它打上这个物体的类别label，并设置概率为1。换句话说，这个概率是存在一个条件的，这个条件就是cell存在物体。</p></li><li><p>对于测试阶段来说，网络直接输出$P_r(Class_i/Object)$ ，就已经可以代表有物体存在的条件下类别概率。但是在测试阶段，作者还把这个概率乘上了confidence。</p><p>论文中的公式为：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/v2-ac13ab74095659e153c79da27052f923_720w.jpg" alt="img"></p><p>也就是说我们预测的条件概率还要乘以confidence。为什么这么做呢？举个例子，对于某个cell来说，在预测阶段，即使这个cell不存在物体（即confidence的值为0），也存在一种可能：输出的条件概率$P_r(Class_i/Object)=0.9$，但是confidence与$P_r(Class_i/Object)=0.9$乘起来就变成0了。这个是很合理的，因为你得确保cell中有物体（即confidence大），你算类别概率才有意义。</p></li></ol><h3 id="定位损失"><a href="#定位损失" class="headerlink" title="定位损失"></a>定位损失</h3><p>定位损失度量预测出的边界框位置与尺寸的误差。我们只计算grid cell中负责对目标进行预测的那个边界框（要求有实际目标的中心点落入到grid cell中，并且与ground truth有着最大IoU，即下面公式中$\mathbb {1_{ij}^{obj}}$的含义）的定位损失：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_BwhGMvffFfqtND9413oiwA.png" alt="img" style="zoom:67%"></p><p>我们不想对大框和小框的绝对误差进行同等加权（例如2个像素点的误差对大目标和小目标应该有着不同的影响，实际上较小的边界框的坐标误差应该要比较大的边界框要更敏感）。为此，YOLO预测边界框宽和高的均方根而不是直接预测宽和高。除此之外，为了将更多的注意力放在边界框准确率上，给定位损失乘以$\lambda_{coord}$，默认为5。</p><h3 id="置信度损失"><a href="#置信度损失" class="headerlink" title="置信度损失"></a>置信度损失</h3><p>对于grid cell中负责预测对应目标的边界框（要求有实际目标的中心点落入到grid cell中，并且与ground truth有着最大IoU，即下面公式中$\mathbb {1_{ij}^{obj}}$的含义），则置信度损失为：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QT7mwEbyLJYIxTYtOWClFQ.png" alt="img" style="zoom:67%"></p><p>对于grid cell中不负责预测对应目标的边界框（要求没有实际目标的中心点落入到grid cell中，或者有实际目标的中心点落入到grid cell中但是与ground truth的IoU不是最大，即下面公式中$\mathbb {1_{ij}^{noobj}}$的含义），则置信度损失为：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_Yc_OJIXOoV2WaGQ6PqhTXA.png" alt="img" style="zoom:67%"></p><p>大多数边框不包含任何目标，因而会导致类别不平衡问题（导致模型偏向于将边界框预测为背景类）。为了纠正这一问题，给不包含目标的边界框的类别损失乘以$\lambda_{noobj}$（默认为0.5）。</p><p><strong>值得注意的是：</strong></p><ol><li><strong>训练阶段</strong>，要给每个boundding box的置信度打label，如果一个物体中心没有落在cell之内，那么每个bounding box的$P_r(object)=0$，IOU就没有算的必要了。如果物体的中心落在了这个cell之内，这个时候$P_r(object)=1$，那么置信度的label就是$1*IOU_{pred}^{truth}$。注意这个IOU是在训练过程中不断计算出来的，网络在训练过程中预测的bounding box每次都不一样，所以和ground truth计算出来的IOU每次也会不一样。</li><li><strong>预测阶段</strong>，网络只输出一个confidence值，它实际上隐含地包含了$P_r(object) \cdot IOU_{pred}^{truth}$。并不需要分别计算$P_r(object)$和$IOU_{pred}^{truth}$（也没办法算）。为什么？因为你在训练阶段你给置信度打label的时候，给的是$P_r(object) \cdot IOU_{pred}^{truth}$，网络吐出来的也是对这个乘积的预测。</li></ol><h3 id="Loss"><a href="#Loss" class="headerlink" title="Loss"></a>Loss</h3><p>将定位损失、置信度损失、分类损失加到一块，得到最终的Loss：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_aW6htqx4Q7APLrSQg2eWDw.png" alt="img" style="zoom:67%"></p><p>需要注意的是，并不是网络的输出都算loss，具体地说：</p><ol><li><strong>有实际物体中心落入的cell</strong>，需要计算<strong>分类损失</strong>，两个predictor都要计算<strong>置信度损失</strong>，预测的bounding box与ground truth IOU比较大的那个predictor需要计算<strong>定位损失</strong></li><li><strong>没有物体中心落入的cell</strong>，只需要计算<strong>置信度损失</strong></li></ol><p>另外，我们发现每一项loss的计算都是L2 loss，即使是分类问题也是。所以说yolo是把分类问题转为了回归问题。</p><h2 id="推理：Non-maximal-suppression"><a href="#推理：Non-maximal-suppression" class="headerlink" title="推理：Non-maximal suppression"></a>推理：Non-maximal suppression</h2><p>对于同一个目标，YOLO可能预测出多个预测框。为了解决这个问题，YOLO使用非极大抑制算法来移除低置信度的重复预测。使用非极大抑制可以提升$2−3\%$的mAP。</p><p>NMS的核心思想是：选择得分最高的作为输出，与该输出重叠的去掉，不断重复这一过程直到所有备选处理完。</p><p>YOLO的NMS计算方法如下：</p><p>网络输出的$7\times 7\times 30$的张量，在每一个网格中，对象$C_i$位于第$j$个bounding box的得分：</p><script type="math/tex;mode=display">
Score_{ij}=P(C_i|Object)*Confidence_j</script><p>它代表着某个对象$C_i$存在于第$j$个bounding box的可能性。</p><p>每个网格有：20个对象的概率*2个bounding box的置信度，共40个得分（候选对象）。49个网格共1960个得分。Andrew Ng建议每种类别分别进行NMS，那么每种类别有 1960/20=98 个得分。</p><p>NMS步骤如下：</p><p>1）设置一个Score的阈值，低于该阈值的候选对象排除掉（将该Score设为0）</p><p>2）遍历每一个类别<br>2.1）遍历该类别的98个得分<br>2.1.1）找到Score最大的那个对象及其bounding box，添加到输出列表<br>2.1.2）对每个Score不为0的候选对象，计算其与上面2.1.1输出对象的bounding box的IOU<br>2.1.3）根据预先设置的IOU阈值，所有高于该阈值（重叠度较高）的候选对象排除掉（将Score设为0）<br>2.1.4）如果所有bounding box要么在输出列表中，要么Score=0，则该类别的NMS完成，返回步骤2处理下一个类别</p><p>3）输出列表即为预测的对象</p><h2 id="YOLO的优缺点"><a href="#YOLO的优缺点" class="headerlink" title="YOLO的优缺点"></a>YOLO的优缺点</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul><li><p>快速，实时处理</p></li><li><p>预测（目标定位和分类）从一个单网络中得到。能够端到端训练提高精度</p></li><li><p>YOLO更加通用。当从自然图像扩展到其他领域(如艺术作品)时，它的性能优于其他方法</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_XbOnbcZmc50hyhhTwhD5QA-1585712286935.png" alt="img"></p></li><li><p>基于区域建议的方法将分类器限定在特定的区域。而YOLO在进行预测时利用的是整幅图的信息。因而，由于利用了额外的背景信息，YOLO预测出的背景区域的false positives样本更少</p></li><li><p>每一个grid预测一个目标，在进行预测时，提升了空间稀疏度</p></li></ul><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul><li>Yolo各个单元格仅仅预测两个边界框，而且属于一个类别</li><li>若多个目标中心点落在同一个cell，则只能预测出一个。整个网络最多可以预测49个目标</li><li>对于小物体，Yolo的表现会不如人意</li><li>定位误差更高，召回率低</li></ul><h2 id="YOLOv2"><a href="#YOLOv2" class="headerlink" title="YOLOv2"></a>YOLOv2</h2><p>相比于YOLO，SSD有着更高的精度。与基于区域的检测方法相比，<strong>YOLO的定位误差更高，且召回率（度量定位所有的目标的能力）更低。</strong>YOLOv2是YOLO的第二个版本，目标在于提升速度的同时，获得更高的精度。</p><h3 id="提升精度"><a href="#提升精度" class="headerlink" title="提升精度"></a>提升精度</h3><h4 id="Batch-normalization"><a href="#Batch-normalization" class="headerlink" title="Batch normalization"></a>Batch normalization</h4><p>在卷积层之后添加了BN层，因而可以去除dropout层，mAP提升2%。</p><h4 id="High-resolution-classifier"><a href="#High-resolution-classifier" class="headerlink" title="High-resolution classifier"></a>High-resolution classifier</h4><p>YOLO的训练过程包含两步。首先，训练一个类似于VGG16的分类网络；接着，使用卷积层替换全连接层并针对目标检测进行端到端的训练。在训练分类器时使用的分辨率为$224×224$，而在训练目标检测时使用的分辨率为$448×448$。YOLOV2首先使用$224 \times 224$的图片训练分类器，然后在$448 \times 448$的分辨率上对分类器微调几个Epoch。这会使得目标检测部分训练更加简单，mAP提升4%。</p><h4 id="使用带Anchor-Boxes的卷积"><a href="#使用带Anchor-Boxes的卷积" class="headerlink" title="使用带Anchor Boxes的卷积"></a>使用带Anchor Boxes的卷积</h4><p>正如在<a href="https://arxiv.org/pdf/1506.02640.pdf" target="_blank" rel="noopener">YOLO paper</a>中所说的那样，训练的起始阶段梯度很不稳定。刚开始，YOLO对边界框进行随意的猜测，导致在一些目标上表现不错，而在一些目标上变现很差，因而导致很剧烈的梯度改变。在训练的早期，预测框都在寻找其应该专注的目标框的形状。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_7iwTsezrn-tSndx96twprA.jpeg" alt="img"></p><p>而在现实世界中，边界框并不是任意的。汽车有着很相似的形状，而行人的宽长比接近0.41。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_krGqonOLMzSE_PWqH_LvQA.jpeg" alt="img" style="zoom:25%"></p><p>因为我们只需要正确的猜测，因此如果有一个适用于现实世界目标的多种多样的初始形状猜测，刚开始的训练将变得比较稳定。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_CGWTPTY0sfvQoxsS0X6VFg.jpeg" alt="img"></p><p>例如，创建如下大小的5个anchor boxes。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_8Q8r9ixjTiKLi1mrF36xCw.jpeg" alt="img"></p><p>在预测过程中，不会直接预测5个任意的边界框，而是预测相对于上述5个anchor boxes的偏移值（offsets ，R-CNN中为regression coefficients）。如果对偏移值进行限制，就可以维持预测的多样性并使得每一个预测集中在特定的形状。因而，初始训练阶段将更加平稳。</p><blockquote><p>在文章中，anchors也被称为priors。</p></blockquote><p>对网络结构的改变如下所示：</p><ol><li><p>移除负责预测边界框的全连接层；</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_tavjieD0Bum_uX-svYUTKA.jpeg" alt="img" style="zoom:67%"></p></li><li><p>将<strong>类别预测</strong>从cell级移动到边界框级（每一个边界框都进行类别预测）。因而，每一个预测包含边界框的四个参数、一个表示是否存在目标的置信度分数（objectness）和20个类别概率。那么，5个边界框就有125个参数。与YOLO相同，objectness prediction仍旧隐藏着ground truth和预测框的IOU。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_UsqjfoW3sLkmyXKQ0Hyo8A.png" alt="img" style="zoom:67%"></p></li><li><p>为了产生大小为$7\times 7 \times 125$的特征图，将最后一层卷积层替换为三个$3 \times 3$大小的卷积层，每一个卷积层输出1024个通道。接着使用最后一层大小为$1 \times 1$的卷积层将$7\times 7\times 1024$大小的输出转换为$7\times 7 \times 125$的大小。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_KiSd2CBfcs5af6oliHCqzw.jpeg" alt="img" style="zoom:67%"></p></li><li><p>将输入图片的大小从$448×448$转换为$416×416$。该大小将产生大小为奇数的特征图（$7 \times 7$ v.s. $8 \times 8$ grid cell）。因为一般来说，大目标的中心点会落在图片的中心。当grid cell的大小为奇数时，将更容易确定该大目标的位置。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_89qezEeLKJLpD8_fM_H4qQ.jpeg" alt="img"></p></li><li><p>移除一层池化层，将网络输出的大小变为$13\times 13$。</p></li></ol><p>引入anchor boxes后，mAP从69.5降低到69.2，但recall从81%提升到88%。也就是说，即使准确率所有下降但是提升了检测到所有ground truth目标的概率。</p><h4 id="维度聚类"><a href="#维度聚类" class="headerlink" title="维度聚类"></a>维度聚类</h4><p>在很多问题领域，其目标的边界框都是有一定的模式的。例如，在自动驾驶领域，常见的两种边界框为不同距离的行人和车辆。为了找出前K个尽可能覆盖训练数据的边界框，我们使用K-均值来聚类得出训练数据的边界框的前K个聚类中心。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_esSmI0UaMr-GrqkUGMg0hA.jpeg" alt="img"></p><p>因为关注的是边界框而非点，所以不能使用常规的空间距离来度量数据点的距离。自然而然，使用IoU进行度量。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_l5wvrPjLlFp6Whgy0MqbKQ.png" alt="img" style="zoom:67%"></p><p>在左侧，我们画出了在使用不同数目的聚类中心（anchors）的情况下，anchors和ground truth之间的平均IoU。随着anchors数目的增加，准确率平缓上升。anchors数目负责多越高，经过平衡后，YOLO选取了5种anchors。在右侧，表示的是5个anchor的形状。蓝色略带紫色矩形框表示COCO数据，黑色矩形框表示VOC2007数据。在两种数据集中，anchors大多表现为瘦和高，这一现象也表明了现实中的边界框不是任意的。</p><blockquote><p>除非特意声明，下文中的YOLO都表示YOLOv2。</p></blockquote><h4 id="直接预测定位"><a href="#直接预测定位" class="headerlink" title="直接预测定位"></a>直接预测定位</h4><p>我们预测的是相对于anchors的偏移量，但是，如果不进行限制的话，预测值将会变得随机。YOLO会预测5个参数$tx,ty,tw,th$和$to$，并使用sigma函数来限制可能的偏移范围。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_38-Tdx-wQA7c3TX5hdnwpw.jpeg" alt="img" style="zoom:50%"></p><p>可视化如下所示：其中，蓝框表示转换后得到的最终预测出的边界框，点框表示anchor。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_gyOSRA_FDz4Pf5njoUb4KQ.jpeg" alt="img" style="zoom:50%"></p><p>通过使用k-均值和上述的改进，mAP提升5%左右。</p><h4 id="细粒度特征（Fine-Grained-Features）"><a href="#细粒度特征（Fine-Grained-Features）" class="headerlink" title="细粒度特征（Fine-Grained Features）"></a>细粒度特征（Fine-Grained Features）</h4><p>卷积层逐渐减小特征图的空间维度。随着分辨率的降低，检测小目标的难度将逐渐增大。其他目标检测算法，诸如SSD，使用多尺度的特征图进行目标检测。因而每一层特征图专注于不同尺度的目标。YOLO使用了一种不同的策略（称为passthrough）。它将大小为$26×26×512$的特征图reshape为$13×13×2048$，接着将该特征图与原始输出的$13×13×1024$的特征图进行拼接。最后，在拼接得到的$13 × 13 × 3072$大小的特征图上进行检测。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_RuW-SCIML8SHc5_PrIE9-g.jpeg" alt="img" style="zoom:50%"></p><h4 id="多尺度训练"><a href="#多尺度训练" class="headerlink" title="多尺度训练"></a>多尺度训练</h4><p>在移除全连接层后，YOLO可以输入不同大小尺寸的图片。如果图片的长和宽都加倍，就会预测的grid的数目就会变为原来的4倍，预测量也变为原来的4倍。因为YOLO网络对输入图片的下采样倍数为32，所以输入的长和宽必须是32的倍数。在训练过程中，YOLO接受$320×320,352×352,…,608×608$大小的特征图（步长为32）。每10个batches，YOLOv2随机从上述尺度中选取一个尺度用于训练。</p><p>这一做法有着数据增强的作用，使得网络对不同大小的输入图片都有着不错的预测能力。因而，可以依据要求的不同选择不同大小的输入图片。需要更高的速度则选择较小的输入图片，需要更高的准确度则选择较大的图片。在$288 \times 288$大小，YOLO能够跑到90FPS，而性能和Fast R-CNN差不多。在输入为高分辨率图像时，YOLO在VOC 2017数据集上实现了78.6的mAP。</p><h4 id="精度"><a href="#精度" class="headerlink" title="精度"></a>精度</h4><p>使用上述改进方法后，性能如下：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_3IdCKSzR5R0lIE1LSmN4Bg.png" alt="img" style="zoom:50%"></p><p>不同目标检测算法的性能比较：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_NJj17Z6FgffYaA4WH2WIjw.png" alt="img"></p><h3 id="速度提升"><a href="#速度提升" class="headerlink" title="速度提升"></a>速度提升</h3><p>对于一张大小为$224×224$的图片，VGG16在一次前向传播中需要30.69 billion次浮点操作，自定义的GoogLeNet需要8.52 billion次。因而可以将VGG16替换为GoogLeNet，但是会导致在ImageNet上的top-5准确率从90.0%下降到88.0%。</p><h4 id="DarkNet"><a href="#DarkNet" class="headerlink" title="DarkNet"></a>DarkNet</h4><p>可以进一步对使用的backbone CNN进行简化。Darknet只需要5.58billion次浮点操作。在Darknet中，大量使用$3×3$卷积提取特征，$1×1$卷积降低输出通道数。并使用全局平均池化来进行预测。网络结构如下（下表的网络结构用于分类任务）：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_8FiQUakp9i4MneU4VXk4Ww.png" alt="img"></p><p>为了将Darknet用于目标检测，将最后的分类层的结构替换为三个$3\times 3$大小的卷积层，每一个卷积层输出1024个通道。接着使用$1 \times 1$卷积将$7\times 7 \times 1024$转换为$7\times 7\times 125$（每1个grid预测5个边界框，每1个边界框预测4个位置参数，1个置信度分数和20个条件类别概率）。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_NBnDpz8fitkhcdnkgF2bvg.png" alt="img" style="zoom:67%"></p><h3 id="训练"><a href="#训练" class="headerlink" title="训练"></a>训练</h3><p>首先使用ImageNet的1000类分类数据集对YOLO训练160个epochs：使用随机梯度下降法，初始学习率为0.1，多项式速率衰减的幂为4，权重衰减系数为0.0005以及动量为0.9。在初始训练阶段，使用大小为$224×224$的分辨率，接着使用$448×448$大小的分辨率，初始学习率为10-3，微调10个epoch。在训练完成后，top-1正确率为76.5%，top-5学习率为93.3%。</p><p>接着，移除全连接层和最后一层卷积层。添加三个大小为$3×3$，输出通道为1024的卷积层，后接大小为$1×1$，输出通道数为125（预测5个box，每一个box为25个参数）的卷积层。同时添加passthrough层。使用初始学习率10-3，分别在第60和90个epoch将学习率衰减10倍，权重衰减为0.0005和动量0.9训练160个epochs。</p><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>与分类任务相比，检测任务的类别数目相对较少。为了拓展可以检测的类别数目，YOLO提出了一种在训练过程中，对分类和目标检测数据集进行融合的方法。在使用目标检测样本训练端到端网络的同时，将来自分类样本的分类损失反向传播到分类支路。该方法需要解决如下的问题：</p><ul><li>如何将不同数据集的类标进行合并？目标检测数据集和不同的分类数据集有着不同的类标。</li><li>合并的类别之间并不是相互独立的。例如，ImageNet中的<em>Norfolk terrier</em> 和COCO中的<em>dog</em>。由于它不是互斥的，无法使用softmax来计算概率</li></ul><h4 id="层次分类（Hierarchical-classification）"><a href="#层次分类（Hierarchical-classification）" class="headerlink" title="层次分类（Hierarchical classification）"></a>层次分类（Hierarchical classification）</h4><p>不谈细节，YOLO将不同数据集中的标签组合在一起，形成了一个树形结构的单词树。子节点与父节点之间形成一个is-a关系，就像双翼飞机是一个飞机一样。但合并后的标签现在并不相互排斥。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_QKwSclDLcT8eJxyj3CVL0w.png" alt="img" style="zoom:50%"></p><p>以1000类的ImageNet为例。并非直接预测1000个类别，而是创建了一个有1000个原始标签结点，369个父类结点的树形结构。最初，YOLO预测biplane的类别分数。但是在WordTree中，预测给定airplane的情况下是biplane的分数。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_TALo1-LuWbF80RTCM7bszw.png" alt="img"></p><p>因为：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0Oyd6FWXo7OJzzuXuXSoDQ.png" alt="img"></p><p>因而可以使用softmax函数来计算概率值：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1__gX42bmgvyib4lyR9GQrAg.png" alt="img"></p><p>不同之处在于，并不是只执行了一次softmax操作，而是对每一个父结点的孩子都执行softmax操作。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1__0ijX5oRZdQCNlSk-gXj3Q.jpeg" alt="img"></p><p>接着通过对树的结点进行遍历，便可以得到YOLO预测出的类别概率：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_0XHKAh0GxpW22y1DlL4hYA.png" alt="img"></p><p>在进行分类时，假设目标已经被检测到，因而$P_r(physical object)=1$。</p><p>层次分类的一个好处是，当YOLO不能区分plane的类型时，它会给plane一个高分，而不是强迫它分到某个子类别。</p><p>当YOLO在执行分类任务时，只会反向传播分类损失来训练分类器。YOLO关注那些对某一类预测出的分数最高的bounding box，同时也计算该类的父结点的分类损失（如果一个bounding box被打上biplane的标签，同时也会被打上airplane 、air、vehicle…）。这一做法鼓励模型提取出这些类别的公共特征。因此，即使我们从未在目标检测中训练过某种特定目标类，我们仍然可以通过将泛化与其相关对象的预测来进行此类的预测。</p><p>在目标检测中，将$\rm P_r(physical\ object)$设置为表征box是否含有目标的box confidence得分。YOLO沿着树向下走时，在每次拆分时都采用最高的置信度路径，直到达到某个阈值，YOLO将预测该对象类。</p><h4 id="YOLO9000"><a href="#YOLO9000" class="headerlink" title="YOLO9000"></a>YOLO9000</h4><p>YOLO9000使用有9418个结点的wordtree进行层次分类来检测超过9000类的目标。它将COCO样本和ImageNet中的前9000个类别进行结合。对于每一个COCO数据，YOLO从ImageNet中采样出4个数据。它学习使用COCO的检测数据进行定位，使用ImageNet中的数据进行分类。</p><p>在评估过程中，YOLO拿它已知的但没有直接用于训练定位器的类别进行测试，即COCO中不存在的类别。YOLO9000从ImageNet目标检测数据集（200个类别）中评估它的结果。它与COCO共享约44个类别。因此，测试数据集包含156个类别，这些类别从未直接参与定位训练。YOLO为相关目标类型提取类似的特性。因此，我们可以通过简单的特征值来检测这156个类别。</p><p>YOLO9000总体mAP为19.7，而这156个类别mAP为16.0。YOLO9000在COCO中没有出现的新动物类别中表现很好，因为它们的形状可以很容易地从它们的父类中概括出来。然而，COCO并没有任何衣服种类的bounding box labels，所以这类数据侧重于预测成“sunglasses”。</p><h2 id="YOLO-V3"><a href="#YOLO-V3" class="headerlink" title="YOLO V3"></a>YOLO V3</h2><h3 id="预测类别"><a href="#预测类别" class="headerlink" title="预测类别"></a>预测类别</h3><p>大多数分类器都假设各个类别之间是互不相关的。因而，YOLO在预测类别时使用softmax函数，softmax函数的输出之和为1。但在YOLOv3中使用multi-label分类，一个目标可能同时属于多个类别（例如输出类标可以W为“pedestrian”和“child”，这不是互斥的）。YOLOv3将softmax函数替换为独立的logistic函数，以计算输入属于某个特定标签的概率。除此之外，YOLOv3未使用均方误差来计算分类损失，而是针对每一个类别使用二分类交叉熵损失。这一做法同时降低了由softmax函数带来的计算复杂度。</p><h3 id="边界框预测和损失函数计算"><a href="#边界框预测和损失函数计算" class="headerlink" title="边界框预测和损失函数计算"></a>边界框预测和损失函数计算</h3><p>YOLOv3使用logistic回归预测每一个边界框的目标分数，并改变了计算损失函数的方式。如果一个bounding box prior（即anchor）与某个ground truth的重合率高于其它的（？？），那么该anchor对应的置信度得分（objectness score）为1。对于剩余的重合度超过预设阈值（default 0.5）的anchors，将不计入损失计算。每一个ground truth只与一个anchor匹配。如果某个anchor未匹配上ground truth，那么它将不被计算分类损失和定位损失，只计算置信度得分。我们使用$t_x$和$t_y$（而不是$b_x$和$b_y$）来计算损失：</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_UuIx6sH39tefFMxgWAaaNQ.png" alt="img"></p><h3 id="Feature-Pyramid-Networks-FPN"><a href="#Feature-Pyramid-Networks-FPN" class="headerlink" title="Feature Pyramid Networks (FPN)"></a>Feature Pyramid Networks (FPN)</h3><p>对于每一个位置，YOLOv3会给出三个预测，每一个预测包含一个边界框、一个置信度得分和80个类别分数（$N × N × [3 × (4 + 1 + 80) ]$）。</p><p>YOLOv3在三个尺度的特征图上进行预测（类似于FPN）：</p><ul><li>在最后一层特征图进行预测；</li><li>将特征图上采样两倍，并退回两层。将具有更高分辨率的特征图与上采样后得到的特征图按照元素相加的方式进行融合。在融合后得到的特征图上卷积并进行第二次预测；</li><li>重复第二步，最终得到的特征图具有较好的高层的语义（结构）信息和用于定位的较好的空间分辨率信息。</li></ul><p>为了确定anchor，YOLOv3使用k-均值聚类，并选择了9个聚类中心。对于COCO，anchors的宽和高依次为： $(10×13),(16×30),(33×23),(30×61),(62×45),(59× 119),(116 × 90),(156 × 198),(373 × 326)$。依据尺度将这9个anchor划分为3个不同的组。每一组被分配给特定的特征图。</p><h3 id="特征提取"><a href="#特征提取" class="headerlink" title="特征提取"></a>特征提取</h3><p>使用Darknet-53结构，该网络结构主要由$3×3$、$1×1$卷积和类似于resnet中的skip connections构成。与ResNet-152相比，Darknet-53有着更小的BFLOP（billion floating point operations），相同精度下，速度为之前的2倍。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_biRYJyCSv-UTbTQTa4Afqg-1585798541494.png" alt="img"></p><h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p>在COCO上，YOLOv3的AP值与SSD持平，但快3倍。但AP仍旧低于RetinaNet。特别的，在AP@IoU=.75时，与RetinaNet相比，性能下降明显表明YOLOv3有着较高的定位误差。在检测小目标的性能上，YOLOv3提升很大。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_bFMwN__ZgfvVRYuo4o8EEg-1585798627659.png" alt="img"></p><p>在快速目标检测算法中，YOLOv3具有较高的性能。</p><p><img src="/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/1_RFpjH8D6TStBaYuZYehe_g-1585798641298.png" alt="img"></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://activepony.com/shen-du-xue-xi/mu-biao-jian-ce/yolo-xi-lie-jie-du/" target="_blank" rel="noopener">实时目标检测：YOLO、YOLOv2以及YOLOv3</a><br><a href="https://medium.com/@jonathan_hui/real-time-object-detection-with-yolo-yolov2-28b1b93e2088" target="_blank" rel="noopener">Real-time Object Detection with YOLO, YOLOv2 and now YOLOv3</a><br><a href="https://zhuanlan.zhihu.com/p/37850811" target="_blank" rel="noopener">你真的读懂yolo了吗？</a><br><a href="https://zhuanlan.zhihu.com/p/46691043" target="_blank" rel="noopener">&lt;机器爱学习&gt;YOLO v1深入理解</a><br><a href="https://zhuanlan.zhihu.com/p/32525231" target="_blank" rel="noopener">目标检测|YOLO原理与实现</a></p></div><div><div style="text-align:center;color:#ccc;font-size:14px">------ 本文结束------</div></div><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/uploads/wechat.png" alt="zdaiot 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/uploads/aipay.jpg" alt="zdaiot 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> zdaiot</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/" title="实时目标检测：YOLO、YOLOv2以及YOLOv3">https://www.zdaiot.com/DeepLearningApplications/目标检测/实时目标检测：YOLO、YOLOv2以及YOLOv3/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/uploads/wechat-qcode.jpg"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/目标检测/" rel="tag"><i class="fa fa-tag"></i> 目标检测</a><a href="/tags/YOLO/" rel="tag"><i class="fa fa-tag"></i> YOLO</a></div><div class="post-nav"><div class="post-nav-item"><a href="/DeepLearningApplications/目标检测/R-CNNs详解/" rel="prev" title="R-CNNs详解"><i class="fa fa-chevron-left"></i> R-CNNs详解</a></div><div class="post-nav-item"> <a href="/DeepLearningApplications/目标检测/SSD详解/" rel="next" title="SSD详解">SSD详解<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#滑动窗口与CNN"><span class="nav-number">1.</span> <span class="nav-text">滑动窗口与CNN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Grid-cell"><span class="nav-number">2.</span> <span class="nav-text">Grid cell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#网络设计"><span class="nav-number">3.</span> <span class="nav-text">网络设计</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#损失函数"><span class="nav-number">4.</span> <span class="nav-text">损失函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#分类损失"><span class="nav-number">4.1.</span> <span class="nav-text">分类损失</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定位损失"><span class="nav-number">4.2.</span> <span class="nav-text">定位损失</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#置信度损失"><span class="nav-number">4.3.</span> <span class="nav-text">置信度损失</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Loss"><span class="nav-number">4.4.</span> <span class="nav-text">Loss</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#推理：Non-maximal-suppression"><span class="nav-number">5.</span> <span class="nav-text">推理：Non-maximal suppression</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#YOLO的优缺点"><span class="nav-number">6.</span> <span class="nav-text">YOLO的优缺点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#优点"><span class="nav-number">6.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缺点"><span class="nav-number">6.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#YOLOv2"><span class="nav-number">7.</span> <span class="nav-text">YOLOv2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#提升精度"><span class="nav-number">7.1.</span> <span class="nav-text">提升精度</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Batch-normalization"><span class="nav-number">7.1.1.</span> <span class="nav-text">Batch normalization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#High-resolution-classifier"><span class="nav-number">7.1.2.</span> <span class="nav-text">High-resolution classifier</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#使用带Anchor-Boxes的卷积"><span class="nav-number">7.1.3.</span> <span class="nav-text">使用带Anchor Boxes的卷积</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#维度聚类"><span class="nav-number">7.1.4.</span> <span class="nav-text">维度聚类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#直接预测定位"><span class="nav-number">7.1.5.</span> <span class="nav-text">直接预测定位</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#细粒度特征（Fine-Grained-Features）"><span class="nav-number">7.1.6.</span> <span class="nav-text">细粒度特征（Fine-Grained Features）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多尺度训练"><span class="nav-number">7.1.7.</span> <span class="nav-text">多尺度训练</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#精度"><span class="nav-number">7.1.8.</span> <span class="nav-text">精度</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#速度提升"><span class="nav-number">7.2.</span> <span class="nav-text">速度提升</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DarkNet"><span class="nav-number">7.2.1.</span> <span class="nav-text">DarkNet</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#训练"><span class="nav-number">7.3.</span> <span class="nav-text">训练</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分类"><span class="nav-number">7.4.</span> <span class="nav-text">分类</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#层次分类（Hierarchical-classification）"><span class="nav-number">7.4.1.</span> <span class="nav-text">层次分类（Hierarchical classification）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#YOLO9000"><span class="nav-number">7.4.2.</span> <span class="nav-text">YOLO9000</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#YOLO-V3"><span class="nav-number">8.</span> <span class="nav-text">YOLO V3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#预测类别"><span class="nav-number">8.1.</span> <span class="nav-text">预测类别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#边界框预测和损失函数计算"><span class="nav-number">8.2.</span> <span class="nav-text">边界框预测和损失函数计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Feature-Pyramid-Networks-FPN"><span class="nav-number">8.3.</span> <span class="nav-text">Feature Pyramid Networks (FPN)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#特征提取"><span class="nav-number">8.4.</span> <span class="nav-text">特征提取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#性能"><span class="nav-number">8.5.</span> <span class="nav-text">性能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">9.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="zdaiot" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">zdaiot</p><div class="site-description" itemprop="description">404NotFound</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">324</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">56</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">381</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zdaiot" title="GitHub → https://github.com/zdaiot" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:zdaiot@163.com" title="E-Mail → mailto:zdaiot@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/" title="知乎 → https://www.zhihu.com/people/" rel="noopener" target="_blank"><i class="fa fa-book fa-fw"></i> 知乎</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/zdaiot" title="CSDN → https://blog.csdn.net/zdaiot" rel="noopener" target="_blank"><i class="fa fa-copyright fa-fw"></i> CSDN</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://kalacloud.com" title="https://kalacloud.com" rel="noopener" target="_blank">卡拉云低代码工具</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">京ICP备2021031914号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">zdaiot</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span title="站点总字数">2.3m</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">34:13</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b5e7e498f94b7ad" async="async"></script></div> <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("08/01/2018 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="Run for "+dnum+" Days ",document.getElementById("times").innerHTML=hnum+" Hours "+mnum+" m "+snum+" s"}setInterval("createtime()",250)</script><div class="busuanzi-count"><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>!function(){var o,n,e=document.getElementsByTagName("link");if(0<e.length)for(i=0;i<e.length;i++)"canonical"==e[i].rel.toLowerCase()&&e[i].href&&(o=e[i].href);n=o?o.split(":")[0]:window.location.protocol.split(":")[0],o||(o=window.location.href),function(){var e=o,i=document.referrer;if(!/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(e)){var t="https"===String(n).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";i?(t+="?r="+encodeURIComponent(document.referrer),e&&(t+="&l="+e)):e&&(t+="?l="+e),(new Image).src=t}}(window)}()</script><script src="/js/local-search.js"></script><div id="pjax"><script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '4800250e682fe873198b',
      clientSecret: '80f7f33f5f8ddfd3944f455cabadda4ff3299147',
      repo        : 'zdaiot.github.io',
      owner       : 'zdaiot',
      admin       : ['zdaiot'],
      id          : 'e05580f676016d88faa58ff47c126971',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0}})</script></body></html>