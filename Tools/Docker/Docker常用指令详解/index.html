<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 3.9.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"www.zdaiot.com",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="Docker 分为客户端和服务端两部分， docker 为客户端调用的命令, dockerd 为服务端调用的命令， 本文着重介绍客户端的用法。 特此声明，下面大部分内容来自于这位大佬，除此之外，还添加了一些自己的理解。 概览主要用法：docker [ docker命令选项 ] [ 子命令 ] [ 子命令选项 ]  docker [ 子命令 ] —help 可查看每个子命令的详细用法。"><meta name="keywords" content="Docker"><meta property="og:type" content="article"><meta property="og:title" content="Docker常用指令详解"><meta property="og:url" content="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/index.html"><meta property="og:site_name" content="zdaiot"><meta property="og:description" content="Docker 分为客户端和服务端两部分， docker 为客户端调用的命令, dockerd 为服务端调用的命令， 本文着重介绍客户端的用法。 特此声明，下面大部分内容来自于这位大佬，除此之外，还添加了一些自己的理解。 概览主要用法：docker [ docker命令选项 ] [ 子命令 ] [ 子命令选项 ]  docker [ 子命令 ] —help 可查看每个子命令的详细用法。"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/image-20200417101555383.png"><meta property="og:updated_time" content="2020-01-04T08:27:53.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Docker常用指令详解"><meta name="twitter:description" content="Docker 分为客户端和服务端两部分， docker 为客户端调用的命令, dockerd 为服务端调用的命令， 本文着重介绍客户端的用法。 特此声明，下面大部分内容来自于这位大佬，除此之外，还添加了一些自己的理解。 概览主要用法：docker [ docker命令选项 ] [ 子命令 ] [ 子命令选项 ]  docker [ 子命令 ] —help 可查看每个子命令的详细用法。"><meta name="twitter:image" content="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/image-20200417101555383.png"><link rel="canonical" href="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>Docker常用指令详解 | zdaiot</title><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0b0b58037319da4959d5a3c014160ccd";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">zdaiot</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">404NotFound</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> 归档</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i> 搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"> <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/uploads/avatar.png"><meta itemprop="name" content="zdaiot"><meta itemprop="description" content="404NotFound"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="zdaiot"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Docker常用指令详解<a href="https://github.com/zdaiot/zdaiot.github.io/tree/hexo/source/_posts/Tools/Docker/Docker常用指令详解.md" class="post-edit-link" title="编辑" rel="noopener" target="_blank"><i class="fa fa-pencil-alt"></i></a></h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-01-04 16:27:53" itemprop="dateCreated datePublished" datetime="2020-01-04T16:27:53+08:00">2020-01-04</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a></span> ， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tools/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a></span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>20k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span>18 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><p><strong>Docker</strong> 分为客户端和服务端两部分， <code>docker</code> 为客户端调用的命令, <code>dockerd</code> 为服务端调用的命令， 本文着重介绍客户端的用法。</p><p>特此声明，下面大部分内容来自于<a href="https://www.jianshu.com/u/c5327915649c" target="_blank" rel="noopener">这位大佬</a>，除此之外，还添加了一些自己的理解。</p><h2 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h2><p>主要用法：<strong>docker [ docker命令选项 ] [ 子命令 ] [ 子命令选项 ]</strong></p><blockquote><p><strong>docker [ 子命令 ] —help</strong> 可查看每个子命令的详细用法。</p></blockquote><p><strong>Docker 命令选项列表</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">选项</th><th style="text-align:center">说明</th><th style="text-align:center">其他</th></tr></thead><tbody><tr><td style="text-align:center">—config [string]</td><td style="text-align:center">客户端本地配置文件路径</td><td style="text-align:center">默认为 <strong>~/.docker</strong></td></tr><tr><td style="text-align:center">-D, —debug</td><td style="text-align:center">启用调试模式</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">—help</td><td style="text-align:center">打印用法</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">-H, —host list</td><td style="text-align:center">通过 <strong>socket</strong> 访问指定的 <strong>docker</strong> 守护进程 ( 服务端 )</td><td style="text-align:center"><strong>unix://</strong> , <strong>fd://</strong> , <strong>tcp://</strong></td></tr><tr><td style="text-align:center">-l, —log-level [string]</td><td style="text-align:center">设置日志级别 ( <strong>debug</strong> 、<strong>info</strong> 、<strong>warn</strong> 、<strong>error</strong> 、<strong>fatal</strong> )</td><td style="text-align:center">默认为 <strong>info</strong></td></tr><tr><td style="text-align:center">—tls</td><td style="text-align:center">启用 <strong>TLS</strong> 加密</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">—tlscacert [string]</td><td style="text-align:center">指定信任的 <strong>CA 根证书</strong> 路径</td><td style="text-align:center">默认为 <strong>~/.docker/ca.pem</strong></td></tr><tr><td style="text-align:center">—tlscert [string]</td><td style="text-align:center">客户端证书路径</td><td style="text-align:center">默认为 <strong>~/.docker/cert.pem</strong></td></tr><tr><td style="text-align:center">—tlskey [string]</td><td style="text-align:center">客户端证书私钥路径</td><td style="text-align:center">默认为 <strong>~/.docker/key.pem</strong></td></tr><tr><td style="text-align:center">—tlsverify</td><td style="text-align:center">启用 <strong>TLS</strong> 加密并验证客户端证书</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">-v, —version</td><td style="text-align:center">打印 <strong>docker</strong> 客户端版本信息</td></tr></tbody></table></div><h2 id="镜像仓库相关"><a href="#镜像仓库相关" class="headerlink" title="镜像仓库相关"></a>镜像仓库相关</h2><h3 id="查找镜像"><a href="#查找镜像" class="headerlink" title="查找镜像"></a>查找镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search [ 条件 ]</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询三颗星及以上名字包含alpine的镜像</span></span><br><span class="line">docker search -f=stars=3 alpine</span><br></pre></td></tr></table></figure><h3 id="获取镜像"><a href="#获取镜像" class="headerlink" title="获取镜像"></a>获取镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull [选项] [Docker Registry 地址[:端口号]/]仓库名[:标签]</span><br></pre></td></tr></table></figure><p>具体的选项可以通过 <code>docker pull --help</code> 命令看到，这里我们说一下镜像名称的格式。</p><ul><li>除了官方仓库外的第三方仓库要指定 <strong>url</strong>，格式一般是 <code>&lt;域名/IP&gt;[:端口号]</code>。默认地址是 Docker Hub。</li><li>仓库名：这里的仓库名是两段式名称，即 <code>&lt;用户名&gt;/&lt;软件名&gt;</code>。对于 Docker Hub，如果不给出用户名，则默认为 <code>library</code>，也就是官方镜像。</li><li><code>标签</code> 表示镜像的版本号，不指定时默认为 <code>latest</code></li></ul><p>比如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker pull ubuntu:18.04</span></span><br><span class="line">18.04: Pulling from library/ubuntu</span><br><span class="line">bf5d46315322: Pull complete</span><br><span class="line">9f13e0ac480c: Pull complete</span><br><span class="line">e8988b5b3097: Pull complete</span><br><span class="line">40af181810e7: Pull complete</span><br><span class="line">e6f7c7e5c03e: Pull complete</span><br><span class="line">Digest: sha256:147913621d9cdea08853f6ba9116c2e27a3ceffecf3b492983ae97c3d643fbbe</span><br><span class="line">Status: Downloaded newer image for ubuntu:18.04</span><br><span class="line">docker.io/library/ubuntu:18.04</span><br></pre></td></tr></table></figure><p>上面的命令中没有给出 Docker 镜像仓库地址，因此将会从 Docker Hub 获取镜像。而镜像名称是 <code>ubuntu:18.04</code>，也就是用户名为默认的<code>library</code>，软件名为<code>ubuntu</code>，标签为<code>18.04</code>。因此将会获取官方镜像 <code>library/ubuntu</code> 仓库中标签为 <code>18.04</code> 的镜像。<code>docker pull</code> 命令的输出结果最后一行给出了镜像的完整名称，即： <code>docker.io/library/ubuntu:18.04</code>。注意这个链接前面是不需要加<code>http://</code>的。</p><h3 id="推送镜像到仓库"><a href="#推送镜像到仓库" class="headerlink" title="推送镜像到仓库"></a>推送镜像到仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push [ 镜像名 ]:[ tag ]</span><br></pre></td></tr></table></figure><p>当然，需要先登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker push alpine</span><br><span class="line">The push refers to a repository [docker.io/library/alpine]</span><br><span class="line">3fb66f713c9f: Layer already exists</span><br><span class="line">errors:</span><br><span class="line">denied: requested access to the resource is denied(没有权限, 需要登录帐号)</span><br><span class="line">unauthorized: authentication required</span><br></pre></td></tr></table></figure><h3 id="登录-退出第三方仓库"><a href="#登录-退出第三方仓库" class="headerlink" title="登录/退出第三方仓库"></a>登录/退出第三方仓库</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker [ login/logout ] [ 仓库地址 ]</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 登录</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker login daocloud.io</span><br><span class="line">Username (username): username</span><br><span class="line">Password:</span><br><span class="line">Login Succeeded</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker logout daocloud.io</span><br><span class="line">Removing login credentials for daocloud.io</span><br></pre></td></tr></table></figure><h2 id="本地镜像"><a href="#本地镜像" class="headerlink" title="本地镜像"></a>本地镜像</h2><h3 id="查看本地镜像"><a href="#查看本地镜像" class="headerlink" title="查看本地镜像"></a>查看本地镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">alpine              latest              a41a7446062d        14 hours ago        3.97MB</span><br><span class="line">hello-world         latest              48b5124b2768        4 months ago        1.84kB</span><br></pre></td></tr></table></figure><h3 id="删除本地镜像"><a href="#删除本地镜像" class="headerlink" title="删除本地镜像"></a>删除本地镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rmi [ 镜像名 or 镜像 id ]</span><br><span class="line">docker rmi $(docker images | grep <span class="string">"^&lt;none&gt;"</span> | awk <span class="string">'&#123;print $3&#125;'</span>) <span class="comment"># 想要删除untagged images，也就是那些id为的image的话可以用</span></span><br></pre></td></tr></table></figure><p>如果用 <strong>镜像 id</strong> 作为参数，可以只输入前几位, 能唯一确定即可 ( 可以同时删除多个镜像, 空格隔开 )。此外, 如果已经使用该 <strong>镜像</strong> 启动了 <strong>容器</strong> 需要先删除 <strong>容器</strong>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker rmi a41</span><br><span class="line">Untagged: alpine:latest</span><br><span class="line">Untagged: alpine@sha256:0b94d1d1b5eb130dd0253374552445b39470653fb1a1ec2d81490948876e462c</span><br><span class="line">Deleted: sha256:a41a7446062d197dd4b21b38122dcc7b2399deb0750c4110925a7dd37c80f118</span><br><span class="line">Deleted: sha256:3fb66f713c9fa9debcdaa58bb9858bd04c17350d9614b7a250ec0ee527319e59</span><br></pre></td></tr></table></figure><p>若遇到错误<code>Error response from daemon: conflict: unable to delete a9aad2420ea3 (must be forced) - image is being used by stopped container 4b42ead3973b</code>，则先使用<code>docker stop $(docker ps -a -q)</code>停止所有的container，这样才能够删除其中的images。</p><p>若还是不行的话，先删除对应的docker。因为该image被对应的container引用，所以image删除失败。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@vm000949 redis]<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY                TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">mia/redis                 v2                  a061cf8c12b8        48 minutes ago      210.7 MB</span><br><span class="line">&lt;none&gt;                    &lt;none&gt;              037c233c605c        2 days ago          203.5 MB</span><br></pre></td></tr></table></figure><p>主要希望删除这两个imgae,根据image的id到container中找</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@vm000949 redis]<span class="comment"># docker ps -a</span></span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                       PORTS               NAMES</span><br><span class="line">1be364973e1d        a061cf8c12b8        <span class="string">"/bin/bash"</span>              42 minutes ago      Exited (137) 5 minutes ago                       thirsty_einstein</span><br><span class="line">65e94723f0ed        037c233c605c        <span class="string">"/bin/sh -c 'yum -y u"</span>   2 days ago          Exited (1) 2 days ago</span><br></pre></td></tr></table></figure><p>然后删除它们</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@vm000949 redis]<span class="comment"># docker rm 65e94723f0ed</span></span><br><span class="line">65e94723f0ed</span><br><span class="line">[root@vm000949 redis]<span class="comment"># docker rm 1be364973e1d</span></span><br><span class="line">1be364973e1d</span><br></pre></td></tr></table></figure><p>再删除镜像：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@vm000949 redis]<span class="comment"># docker rmi a061cf8c12b8</span></span><br><span class="line">Untagged: mia/redis:v2</span><br><span class="line">Deleted: sha256:a061cf8c12b8a23ea9fe85ebcfc32615f8e9a38dd95961b0dd80ceae658cdc5a</span><br><span class="line">Deleted: sha256:f80464ae70055852f02c7763858dd97121c0e3d77430cb4df2dc70aec1c19678</span><br><span class="line">Deleted: sha256:cdcbccf2d746d094040b8383868120d6d73327827b6ee83a8989baab9bf5fa42</span><br><span class="line">[root@vm000949 redis]<span class="comment"># docker rmi 037c233c605c</span></span><br><span class="line">Deleted: sha256:037c233c605c5b4266ef6cc208d6c1a07b01fab77e848ec0bbb3bb01bdb3fda1</span><br><span class="line">Deleted: sha256:7e07f5920a8cef8dbc5a5a663b14dc37d1112b259d93629aa8ded32f0ea0a6ae</span><br></pre></td></tr></table></figure><p>也可以根据提示来的，加<code>-f</code>强制删除镜像。</p><p>值得注意的是，若遇到错误<code>Error response from daemon: conflict: unable to delete cc6f00f7df14 (cannot be forced) - image has dependent child images</code>，则可以使用<code>docker image inspect --format=&#39;{ {.RepoTags} } { {.Id} } { {.Parent} }&#39; $(docker image ls -q --filter since=cc6f00f7df14)</code>查看到有另外的 image FROM 了这个 image。可以通过删除子镜像来删除该镜像。</p><h3 id="查看镜像详情"><a href="#查看镜像详情" class="headerlink" title="查看镜像详情"></a>查看镜像详情</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect [ 镜像名 or 镜像 id ]</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker inspect a41</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">"Id"</span>: <span class="string">"sha256:a41a7446062d197dd4b21b38122dcc7b2399deb0750c4110925a7dd37c80f118"</span>,</span><br><span class="line">        <span class="string">"RepoTags"</span>: [</span><br><span class="line">            <span class="string">"alpine:latest"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"RepoDigests"</span>: [</span><br><span class="line">            <span class="string">"alpine@sha256:0b94d1d1b5eb130dd0253374552445b39470653fb1a1ec2d81490948876e462c"</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"Parent"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Comment"</span>: <span class="string">""</span>,</span><br><span class="line">        <span class="string">"Created"</span>: <span class="string">"2017-05-25T23:33:22.029729271Z"</span>,</span><br><span class="line">        <span class="string">"Container"</span>: <span class="string">"19ee1cd90c07eb7b3c359aaec3706e269a871064cca47801122444cef51c5038"</span>,</span><br><span class="line">    ......</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="打包本地镜像-使用压缩包来完成迁移"><a href="#打包本地镜像-使用压缩包来完成迁移" class="headerlink" title="打包本地镜像, 使用压缩包来完成迁移"></a>打包本地镜像, 使用压缩包来完成迁移</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker save [ 镜像名 ] &gt; [ 文件路径 ]</span><br><span class="line">或者</span><br><span class="line">docker save -o [ 文件路径 ]  [ 镜像名 ]</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认为文件流输出</span></span><br><span class="line">docker save alpine &gt; /usr/anyesu/docker/alpine.img</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者使用 '-o' 选项指定输出文件路径</span></span><br><span class="line">docker save -o /usr/anyesu/docker/alpine.tar alpine</span><br></pre></td></tr></table></figure><blockquote><p>值得注意的是，若是跨系统打包docker，要使用<code>-o</code>的方式打包，用<code>-i</code>的方式解压。</p></blockquote><h3 id="导入镜像压缩包"><a href="#导入镜像压缩包" class="headerlink" title="导入镜像压缩包"></a>导入镜像压缩包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当文件流输出的时候</span></span><br><span class="line">docker load &lt; [ 文件路径 ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当 '-o' 选项指定输出文件路径</span></span><br><span class="line">docker load -i [文件路径]</span><br></pre></td></tr></table></figure><p>例如</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认从标准输入读取</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker load &lt; /usr/anyesu/docker/alpine.img</span><br><span class="line">3fb66f713c9f: Loading layer [==================================================&gt;]  4.221MB/4.221MB</span><br><span class="line">Loaded image: alpine:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 '-i' 选项指定输入文件路径</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker load -i /usr/anyesu/docker/alpine.img</span><br><span class="line">Loaded image: alpine:latest</span><br><span class="line">Loaded image ID: sha256:665ffb03bfaea7d8b7472edc0a741b429267db249b1fcead457886e861eae25f</span><br><span class="line">Loaded image ID: sha256:a41a7446062d197dd4b21b38122dcc7b2399deb0750c4110925a7dd37c80f118</span><br></pre></td></tr></table></figure><h3 id="修改镜像tag"><a href="#修改镜像tag" class="headerlink" title="修改镜像tag"></a>修改镜像tag</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag [ 镜像名 or 镜像 id ] [ 新镜像名 ]:[ 新 tag ]</span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker tag a41 anyesu/alpine:1.0</span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">anyesu/alpine       1.0                 a41a7446062d        15 hours ago        3.97MB</span><br><span class="line">alpine              latest              a41a7446062d        15 hours ago        3.97MB</span><br><span class="line">hello-world         latest              48b5124b2768        4 months ago        1.84kB</span><br></pre></td></tr></table></figure><h2 id="容器相关"><a href="#容器相关" class="headerlink" title="容器相关"></a>容器相关</h2><h3 id="创建、启动容器并执行相应的命令"><a href="#创建、启动容器并执行相应的命令" class="headerlink" title="创建、启动容器并执行相应的命令"></a>创建、启动容器并执行相应的命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [ 参数 ] [ 镜像名 or 镜像 id ] [ 命令 ]</span><br></pre></td></tr></table></figure><p>如果没有指定命令时就执行 <strong>镜像</strong> 中默认的命令, 创建 <strong>镜像</strong> 的时候可设置默认命令。另外要注意的一点，<strong>启动 容器 后要执行一个前台进程 ( 就是能在控制台不断输出的或者一直等待的那种程序，如 tomcat 的 catalina.sh ) 才能使 容器 保持运行状态</strong>，否则，命令执行完 <strong>容器</strong> 就关闭了，像下面这个例子执行完就直接结束了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker run hello-world</span><br><span class="line"></span><br><span class="line">Hello from Docker!</span><br><span class="line">This message shows that your installation appears to be working correctly.</span><br><span class="line"></span><br><span class="line">To generate this message, Docker took the following steps:</span><br><span class="line"> 1. The Docker client contacted the Docker daemon.</span><br><span class="line"> 2. The Docker daemon pulled the <span class="string">"hello-world"</span> image from the Docker Hub.</span><br><span class="line"> 3. The Docker daemon created a new container from that image <span class="built_in">which</span> runs the</span><br><span class="line">    executable that produces the output you are currently reading.</span><br><span class="line"> 4. The Docker daemon streamed that output to the Docker client, <span class="built_in">which</span> sent it</span><br><span class="line">    to your terminal.</span><br><span class="line"></span><br><span class="line">To try something more ambitious, you can run an Ubuntu container with:</span><br><span class="line"> $ docker run -it ubuntu bash</span><br><span class="line"></span><br><span class="line">Share images, automate workflows, and more with a free Docker ID:</span><br><span class="line"> https://cloud.docker.com/</span><br><span class="line"></span><br><span class="line">For more examples and ideas, visit:</span><br><span class="line"> https://docs.docker.com/engine/userguide/</span><br></pre></td></tr></table></figure><p><strong>run 命令常用选项</strong></p><div class="table-container"><table><thead><tr><th style="text-align:center">选项</th><th style="text-align:center">说明</th></tr></thead><tbody><tr><td style="text-align:center">-d</td><td style="text-align:center">后台运行容器, 并返回容器ID；不指定时, 启动后开始打印日志, <code>Ctrl + C</code> 退出命令同时会关闭容器</td></tr><tr><td style="text-align:center">-i</td><td style="text-align:center">以交互模式运行容器, 通常与 <strong>-t</strong> 同时使用；</td></tr><tr><td style="text-align:center">-t</td><td style="text-align:center">为容器重新分配一个伪输入终端, 通常与 <strong>-i</strong> 同时使用</td></tr><tr><td style="text-align:center">—name “anyesu-container”</td><td style="text-align:center">为容器指定一个别名, 不指定时随机生成</td></tr><tr><td style="text-align:center">-h docker-anyesu</td><td style="text-align:center">设置容器的主机名, 默认随机生成</td></tr><tr><td style="text-align:center">—dns 8.8.8.8</td><td style="text-align:center">指定容器使用的 <strong>DNS</strong> 服务器, 默认和宿主机一致</td></tr><tr><td style="text-align:center">-e docker_host=172.17.0.1</td><td style="text-align:center">设置环境变量</td></tr><tr><td style="text-align:center">—cpuset=”0-2” or —cpuset=”0,1,2”</td><td style="text-align:center">绑定容器到指定 <strong>CPU</strong> 运行</td></tr><tr><td style="text-align:center">-m 100M</td><td style="text-align:center">设置容器使用内存最大值</td></tr><tr><td style="text-align:center">—net bridge</td><td style="text-align:center">指定容器的网络连接类型, 支持 <strong>bridge</strong> / <strong>host</strong> / <strong>none</strong> / <strong>container</strong> 四种类型</td></tr><tr><td style="text-align:center">—ip 172.18.0.13</td><td style="text-align:center">为容器分配固定 <strong>ip</strong> ( 需要使用自定义网络 )</td></tr><tr><td style="text-align:center">—expose 8081 —expose 8082</td><td style="text-align:center">开放一个端口或一组端口, 会覆盖镜像设置中开放的端口</td></tr><tr><td style="text-align:center">-p [宿主机端口]:[容器内端口]</td><td style="text-align:center">宿主机到容器的端口映射, 可指定宿主机的要监听的 <strong>ip</strong>, 默认为 <strong>0.0.0.0</strong></td></tr><tr><td style="text-align:center">-P</td><td style="text-align:center">注意是大写的, 宿主机随机指定一组可用的端口映射容器 <strong>expose</strong> 的所有端口</td></tr><tr><td style="text-align:center">-v [宿主机目录路径]:[容器内目录路径]</td><td style="text-align:center">挂载宿主机的指定目录 ( 或文件 ) 到容器内的指定目录 ( 或文件 )</td></tr><tr><td style="text-align:center">—add-host [主机名]:[ip]</td><td style="text-align:center">为容器 <strong>hosts</strong> 文件追加 <strong>host</strong> , 默认会在 <strong>hosts</strong> 文件最后追加内容：<code>[主机名]:[容器ip]</code></td></tr><tr><td style="text-align:center">—volumes-from [其他容器名]</td><td style="text-align:center">将其他容器的数据卷添加到此容器</td></tr><tr><td style="text-align:center">—link [其他容器名]:[在该容器中的别名]</td><td style="text-align:center">添加链接到另一个容器, 在本容器 <strong>hosts</strong> 文件中加入关联容器的记录, 效果类似于 <strong>—add-host</strong></td></tr></tbody></table></div><p><strong>一个较完整的例子：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个名为anyesu_net、网段为172.18.0.0的网桥(docker默认创建的网段为172.17.0.0)</span></span><br><span class="line">docker network create --subnet=172.18.0.0/16 anyesu_net</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并启动一个配置复杂的容器</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker run -d --name anyesu-container -h docker-anyesu --dns 8.8.8.8 -e docker_host=172.18.0.1 -e docker_host2=172.18.0.2 --net anyesu_net --ip 172.18.0.13 --expose 8081 --expose 8082 -P -p 8000:8000 -p 8001:8001 -v /usr/anyesu:/usr/anyesu --add-host anyesu_host:172.18.0.1 tomcat:7</span><br><span class="line">912e6632161de0783a057aa02380e676753f66cfb367ef1686d4d09cdc931659</span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                                                                                                         NAMES</span><br><span class="line">912e6632161d        tomcat:7              <span class="string">"catalina.sh run"</span>   6 seconds ago       Up 5 seconds        0.0.0.0:8000-8001-&gt;8000-8001/tcp, 0.0.0.0:32783-&gt;8080/tcp, 0.0.0.0:32782-&gt;8081/tcp, 0.0.0.0:32781-&gt;8082/tcp   anyesu-container</span><br></pre></td></tr></table></figure><blockquote><p><strong>单字符选项可以合并, 如 <code>-i -t</code> 可以合并为 <code>-it</code></strong></p></blockquote><p><strong>另一个完整的例子：</strong></p><p>使用<code>docker images</code>查看当前的docker镜像如下。</p><p><img src="/Tools/Docker/Docker常用指令详解/image-20200417101555383.png" alt="image-20200417101555383"></p><p>则启动docker镜像的命令可以是：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将/data6/zhaodali映射到/workspace文件夹</span></span><br><span class="line">docker run --gpus all -v /data6/zhaodali:/workspace -ti ubuntu-opencv-torch:latest /bin/bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启之后运行ls指令，看到将/data6/zhaodali映射到/workspace文件夹</span></span><br><span class="line">root@16aa6953dfb3:/workspace<span class="comment"># ls</span></span><br><span class="line">AilabFaceSecuritySDK-v1.0.0  backup  faceDataset  faceDataset_detect  faceDataset_extract  fddb_images  testAilabFaceSecuritySDK-v1.0.0  zhaodali_replay.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 若想将/data4/zhaodali映射到/workspace文件夹，则使用下面指令</span></span><br><span class="line">docker run --gpus all -v /data4/zhaodali:/workspace -ti ubuntu-opencv-torch:latest /bin/bash</span><br></pre></td></tr></table></figure><p>想要退出的话，直接按下<code>ctrl + D</code>指令。</p><p>若想在docker内连接内网源安装软件和Python包，则需要运行下面指令，然后更改镜像内的apt软件源和pip源为内网源。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --gpus all -v /dev/dri:/dev/dri --ipc=host -it --add-host mirrors.tencent.com:100.115.83.221 --add-host mirrors.cloud.tencent.com:100.115.83.221 -v /data6/zhaodali:/workspace -ti ubuntu-opencv-torch:latest /bin/bash</span><br></pre></td></tr></table></figure><blockquote><p>若进入docker后还是连不上内网，则将<code>--ipc=host</code>改为<code>--network=host</code>。</p><p>若出现错误<code>ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm)</code>，则在开启docker的时候加上<code>--ipc=host</code>指令，让docker容器共享主机内存。</p></blockquote><h3 id="查看运行中的容器"><a href="#查看运行中的容器" class="headerlink" title="查看运行中的容器"></a>查看运行中的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看运行中的容器</span></span><br><span class="line">docker ps</span><br><span class="line"><span class="comment"># 查看所有的容器</span></span><br><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><h3 id="开启-停止-重启容器"><a href="#开启-停止-重启容器" class="headerlink" title="开启/停止/重启容器"></a>开启/停止/重启容器</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 关闭容器(发送SIGTERM信号,做一些<span class="string">'退出前工作'</span>,再发送SIGKILL信号)</span></span><br><span class="line">docker stop anyesu-container</span><br><span class="line"><span class="meta">#</span><span class="bash"> 强制关闭容器(默认发送SIGKILL信号, 加-s参数可以发送其他信号)</span></span><br><span class="line">docker kill anyesu-container</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动容器</span></span><br><span class="line">docker start anyesu-container</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启容器</span></span><br><span class="line">docker restart anyesu-container</span><br></pre></td></tr></table></figure><h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm [ 容器名 or 容器 id ]</span><br></pre></td></tr></table></figure><p>可以指定多个容器一起删除, 加 <code>-f</code> 选项可强制删除正在运行的 <strong>容器</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS                                                                                                         NAMES</span><br><span class="line">fd7a6c1ba0f0        tomcat              "catalina.sh run"   20 seconds ago       Up 18 seconds       0.0.0.0:32798-&gt;8080/tcp, 0.0.0.0:32797-&gt;8081/tcp, 0.0.0.0:32796-&gt;8082/tcp                                     musing_newton</span><br><span class="line">61941bea1c87        tomcat              "catalina.sh run"   About a minute ago   Up About a minute   0.0.0.0:8000-8001-&gt;8000-8001/tcp, 0.0.0.0:32795-&gt;8080/tcp, 0.0.0.0:32794-&gt;8081/tcp, 0.0.0.0:32793-&gt;8082/tcp   anyesu-container</span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker rm musing_newton anyesu-container -f</span><br><span class="line">musing_newton</span><br><span class="line">anyesu-container</span><br></pre></td></tr></table></figure><h3 id="查看容器详情"><a href="#查看容器详情" class="headerlink" title="查看容器详情"></a>查看容器详情</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect [ 容器名 or 容器 id ]</span><br></pre></td></tr></table></figure><p>比如</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect anyesu-container</span><br></pre></td></tr></table></figure><h3 id="查看容器中正在运行的进程"><a href="#查看容器中正在运行的进程" class="headerlink" title="查看容器中正在运行的进程"></a>查看容器中正在运行的进程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top [ 容器名 or 容器 id ]</span><br></pre></td></tr></table></figure><p>比如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker top anyesu-container</span><br><span class="line">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br><span class="line">root                31769               31752               1                   00:26               ?                   00:00:03            /docker-java-home/jre/bin/java -Djava.util.logging.config.file=/usr/local/tomcat/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djdk.tls.ephemeralDHKeySize=2048 -Djava.protocol.handler.pkgs=org.apache.catalina.webresources -classpath /usr/local/tomcat/bin/bootstrap.jar:/usr/local/tomcat/bin/tomcat-juli.jar -Dcatalina.base=/usr/local/tomcat -Dcatalina.home=/usr/local/tomcat -Djava.io.tmpdir=/usr/local/tomcat/temp org.apache.catalina.startup.Bootstrap start</span><br></pre></td></tr></table></figure><h3 id="保存容器"><a href="#保存容器" class="headerlink" title="保存容器"></a>保存容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker commit [ 容器名 or 容器 id ] [ 镜像名 ]:[ tag ]</span><br></pre></td></tr></table></figure><p>比如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker commit anyesu-container anyesu/tomcat:1.0</span><br><span class="line">sha256:582fcffd3209a2478e2179c9381a1ef67e0df9ba95aba713875c0857f5dae4e5</span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker images</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">anyesu/tomcat       1.0                 582fcffd3209        2 seconds ago       334MB</span><br><span class="line">alpine              latest              a41a7446062d        17 hours ago        3.97MB</span><br><span class="line">tomcat              latest              3695a0fe8320        2 days ago          334MB</span><br><span class="line">hello-world         latest              48b5124b2768        4 months ago        1.84kB</span><br></pre></td></tr></table></figure><p>再比如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(base) [zhaodali@TENCENT64 /data6/zhaodali]$ docker ps -l</span><br><span class="line">CONTAINER ID        IMAGE                      COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">c433608fdb59        cwaffles/openpose:latest   <span class="string">"/bin/bash"</span>         3 hours ago         Up 3 hours                              eager_mclean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 容器id可以只写几位</span></span><br><span class="line">(base) [zhaodali@TENCENT64 /data6/zhaodali]$ docker commit c4336 cwaffles/openpose:1.0</span><br><span class="line">sha256:8208e6744b38479b2728e83a30adbfdc7e0baa15cc0f431d2d2bf53e14a9577f</span><br></pre></td></tr></table></figure><h3 id="开启新终端进入同一个docker"><a href="#开启新终端进入同一个docker" class="headerlink" title="开启新终端进入同一个docker"></a>开启新终端进入同一个docker</h3><p>可以先通过<code>docker ps</code>获取<code>container id</code>，然后通过<code>docker exec -it ${container_id} /bin/bash</code> 进入，如果不是<code>/bin/bash</code>环境，可以使用<code>/bin/sh</code>进入。</p><h3 id="使用-Dockerfile-构建镜像"><a href="#使用-Dockerfile-构建镜像" class="headerlink" title="使用 Dockerfile 构建镜像"></a>使用 Dockerfile 构建镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t [ 镜像名 ]:[ tag ] -f [ DockerFile 名 ] [ DockerFile 所在目录 ]</span><br></pre></td></tr></table></figure><p>数据是实时更新的，<a href="https://www.jianshu.com/p/a0892512f86c" target="_blank" rel="noopener">点击</a> 查看详细用法。</p><p>若在构建镜像时，出现了无法连接网络安装依赖时，可以在上面指令后面添加<code>--network=host</code>。</p><h3 id="映射jupyter-notebook"><a href="#映射jupyter-notebook" class="headerlink" title="映射jupyter-notebook"></a>映射jupyter-notebook</h3><p>启动Docker：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NV_GPU=0 nvidia-docker run -it -p 7777:8888 -ti --ipc=host a9aad2420ea3</span><br></pre></td></tr></table></figure><p>使用<code>docker ps</code>查看刚启动的container实例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                              NAMES</span><br><span class="line">cc56fc116249        78c6f941bef3        <span class="string">"/bin/bash"</span>         10 hours ago        Up 10 hours         6006/tcp, 0.0.0.0:7777-&gt;8888/tcp   pedantic_gagarin</span><br></pre></td></tr></table></figure><p>可以看到，这里container实例开放了6006和8888两个端口，其中8888端口映射到了主机的7777端口。此时进入Docker，在需要执行<code>jupyter notebook</code>的文件夹内打开终端运行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(solaris) root@cc56fc116249:/opt/conda/pkgs<span class="comment"># jupyter notebook --ip 0.0.0.0 --no-browser --allow-root &amp;</span></span><br><span class="line">[1] 14781</span><br><span class="line">(solaris) root@cc56fc116249:/opt/conda/pkgs<span class="comment"># [I 11:27:03.688 NotebookApp] JupyterLab extension loaded from /opt/conda/envs/solaris/lib/python3.7/site-packages/jupyterlab</span></span><br><span class="line">[I 11:27:03.688 NotebookApp] JupyterLab application directory is /opt/conda/envs/solaris/share/jupyter/lab</span><br><span class="line">[I 11:27:03.690 NotebookApp] Serving notebooks from <span class="built_in">local</span> directory: /opt/conda/pkgs</span><br><span class="line">[I 11:27:03.690 NotebookApp] Jupyter Notebook 6.1.4 is running at:</span><br><span class="line">[I 11:27:03.690 NotebookApp] http://cc56fc116249:8888/?token=dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</span><br><span class="line">[I 11:27:03.690 NotebookApp]  or http://127.0.0.1:8888/?token=dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</span><br><span class="line">[I 11:27:03.690 NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).</span><br><span class="line">[C 11:27:03.693 NotebookApp] </span><br><span class="line">    </span><br><span class="line">    To access the notebook, open this file <span class="keyword">in</span> a browser:</span><br><span class="line">        file:///root/.<span class="built_in">local</span>/share/jupyter/runtime/nbserver-14781-open.html</span><br><span class="line">    Or copy and paste one of these URLs:</span><br><span class="line">        http://cc56fc116249:8888/?token=dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</span><br><span class="line">     or http://127.0.0.1:8888/?token=dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</span><br></pre></td></tr></table></figure><p>回到主机，在浏览器中打开<code>http://127.0.0.1:7777/?token=dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</code>（注意需要将上面链接中的8888端口替换为7777端口）。如果需要输入token，则输入后面的<code>dcb8fd9afd7f4182fa3f2c4ecf39df2a1090bd62599e20f1</code>即可。</p><h2 id="硬件资源相关"><a href="#硬件资源相关" class="headerlink" title="硬件资源相关"></a>硬件资源相关</h2><h3 id="显示容器硬件资源使用情况"><a href="#显示容器硬件资源使用情况" class="headerlink" title="显示容器硬件资源使用情况"></a>显示容器硬件资源使用情况</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stats [ 选项 ] [ 0个或多个正在运行容器 ]</span><br></pre></td></tr></table></figure><p>比如：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 不指定容器时显示所有正在运行的容器</span></span><br><span class="line">ubuntu@VM-84-201-ubuntu:~$ docker stats</span><br><span class="line">CONTAINER           CPU %               MEM USAGE / LIMIT     MEM %               NET I/O             BLOCK I/O           PIDS</span><br><span class="line">9bb9d6bed6e6        0.00%               20.57MiB / 864.5MiB   2.38%               104kB / 1.99MB      4.9MB / 4.1kB       11</span><br></pre></td></tr></table></figure><h3 id="更新容器的硬件资源限制"><a href="#更新容器的硬件资源限制" class="headerlink" title="更新容器的硬件资源限制"></a>更新容器的硬件资源限制</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker update [ 选项 ]</span><br></pre></td></tr></table></figure><p>这个操作可能会输出下面的错误内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Your kernel does not support swap limit capabilities or the cgroup is not mounted. Memory limited without swap</span><br></pre></td></tr></table></figure><p><a href="https://segmentfault.com/q/1010000002888521#a-1020000002890127" target="_blank" rel="noopener">解决办法</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> /etc/default/grub</span></span><br><span class="line">sudo vi /etc/default/grub</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加内核启动参数</span></span><br><span class="line">GRUB_CMDLINE_LINUX="...   cgroup_enable=memory swapaccount=1"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 更新 grub</span></span><br><span class="line">sudo update-grub</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启</span></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>注意是在 <strong>GRUB_CMDLINE_LINUX</strong> 项 <strong>追加</strong> 上述参数内容, 我试过简单粗暴的在文件末尾添加下面内容, 这么做会覆盖原有的启动参数, 导致网络连接失败。网络坏了, <strong>ssh</strong> 都连不上了, 幸好可以在 <strong>腾讯云</strong> 的网页控制台登录, 修改内容重启就好了。所以呢, 这一步操作一定要慎重。</p><h3 id="使用压力测试工具-stress-验证效果"><a href="#使用压力测试工具-stress-验证效果" class="headerlink" title="使用压力测试工具 stress 验证效果"></a>使用压力测试工具 <code>stress</code> 验证效果</h3><p>使用已有的 <strong>stress</strong> 镜像 <a href="https://hub.docker.com/r/progrium/stress" target="_blank" rel="noopener">progrium/stress</a>, 开两个终端, 在其中一个终端中执行下面的命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -m 100m --rm -it progrium/stress --cpu 2 --io 1 --vm 10 --vm-bytes 9M</span><br></pre></td></tr></table></figure><p>在另一个终端执行 <code>docker stats</code> 进行监控</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER           CPU %               MEM USAGE / LIMIT   MEM %               NET I/O             BLOCK I/O           PIDS</span><br><span class="line">9eb0                88.42%              92.22MiB / 100MiB   92.22%              0B / 0B             1.65MB / 2.88MB     14</span><br></pre></td></tr></table></figure><p>再开一个终端执行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 9eb0为容器id开头, 请根据实际情况替换。内存限制只能调大不能调小</span></span><br><span class="line">docker update -m 200m 9eb0</span><br></pre></td></tr></table></figure><h2 id="基础子命令列表"><a href="#基础子命令列表" class="headerlink" title="基础子命令列表"></a>基础子命令列表</h2><div class="table-container"><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>attach</td><td>进入运行中的容器, 显示该容器的控制台界面。注意, 从该指令退出会导致容器关闭</td></tr><tr><td>build</td><td>根据 <strong>Dockerfile</strong> 文件构建镜像</td></tr><tr><td>commit</td><td>提交容器所做的改为为一个新的镜像</td></tr><tr><td>cp</td><td>在容器和宿主机之间复制文件</td></tr><tr><td>create</td><td>根据镜像生成一个新的容器</td></tr><tr><td>diff</td><td>展示容器相对于构建它的镜像内容所做的改变</td></tr><tr><td>events</td><td>实时打印服务端执行的事件</td></tr><tr><td>exec</td><td>在已运行的容器中执行命令</td></tr><tr><td>export</td><td>导出容器到本地快照文件</td></tr><tr><td>history</td><td>显示镜像每层的变更内容</td></tr><tr><td>images</td><td>列出本地所有镜像</td></tr><tr><td>import</td><td>导入本地容器快照文件为镜像</td></tr><tr><td>info</td><td>显示 <strong>Docker</strong> 详细的系统信息</td></tr><tr><td>inspect</td><td>查看容器或镜像的配置信息, 默认为 <strong>json</strong> 数据</td></tr><tr><td>kill</td><td><strong>-s</strong> 选项向容器发送信号, 默认为 <strong>SIGKILL</strong> 信号 ( 强制关闭 )</td></tr><tr><td>load</td><td>导入镜像压缩包</td></tr><tr><td>login</td><td>登录第三方仓库</td></tr><tr><td>logout</td><td>退出第三方仓库</td></tr><tr><td>logs</td><td>打印容器的控制台输出内容, <strong>-f</strong> 选项可以持续输出</td></tr><tr><td>pause</td><td>暂停容器</td></tr><tr><td>port</td><td>容器端口映射列表</td></tr><tr><td>ps</td><td>列出正在运行的容器, <strong>-a</strong> 选项显示所有容器</td></tr><tr><td>pull</td><td>从镜像仓库拉取镜像</td></tr><tr><td>push</td><td>将镜像推送到镜像仓库</td></tr><tr><td>rename</td><td>重命名容器名</td></tr><tr><td>restart</td><td>重启容器</td></tr><tr><td>rm</td><td>删除已停止的容器, <strong>-f</strong> 选项可强制删除正在运行的容器</td></tr><tr><td>rmi</td><td>删除镜像 ( 必须先删除该镜像构建的所有容器 )</td></tr><tr><td>run</td><td>根据镜像生成并进入一个新的容器</td></tr><tr><td>save</td><td>打包本地镜像, 使用压缩包来完成迁移</td></tr><tr><td>search</td><td>查找镜像</td></tr><tr><td>start</td><td>启动关闭的容器</td></tr><tr><td>stats</td><td>显示容器对资源的使用情况 ( 内存、CPU、磁盘等 )</td></tr><tr><td>stop</td><td>关闭正在运行的容器</td></tr><tr><td>tag</td><td>修改镜像 <strong>tag</strong></td></tr><tr><td>top</td><td>显示容器中正在运行的进程 ( 相当于容器内执行 <strong>ps -ef</strong> 命令 )</td></tr><tr><td>unpause</td><td>恢复暂停的容器</td></tr><tr><td>update</td><td>更新容器的硬件资源限制 ( 内存、CPU 等 )</td></tr><tr><td>version</td><td>显示 <strong>Docker</strong> 客户端和服务端版本信息</td></tr><tr><td>wait</td><td>阻塞当前命令直到对应的容器被关闭, 容器关闭后打印结束代码</td></tr><tr><td>daemon</td><td>这个子命令已 <strong>过期</strong>, 将在 <strong>Docker 17.12</strong> 之后的版本中移出, 直接使用 <strong>dockerd</strong></td></tr></tbody></table></div><h2 id="用于管理的子命令列表"><a href="#用于管理的子命令列表" class="headerlink" title="用于管理的子命令列表"></a>用于管理的子命令列表</h2><div class="table-container"><table><thead><tr><th>选项</th><th>说明</th></tr></thead><tbody><tr><td>container</td><td>管理容器</td></tr><tr><td>image</td><td>管理镜像</td></tr><tr><td>network</td><td>管理容器网络 ( 默认为 <strong>bridge</strong>、<strong>host</strong>、<strong>none</strong> 三个网络配置)</td></tr><tr><td>plugin</td><td>管理插件</td></tr><tr><td>system</td><td>管理系统资源。其中, <strong>docker system prune</strong> 命令用于清理没有使用的镜像、容器、数据卷以及网络</td></tr><tr><td>volume</td><td>管理数据卷</td></tr><tr><td>swarm</td><td>管理 <strong>Swarm</strong> 模式</td></tr><tr><td>service</td><td>管理 <strong>Swarm</strong> 模式下的服务</td></tr><tr><td>node</td><td>管理 <strong>Swarm</strong> 模式下的 <strong>Docker</strong> 集群中的节点</td></tr><tr><td>secret</td><td>管理 <strong>Swarm</strong> 模式下的敏感数据</td></tr><tr><td>stack</td><td><strong>Swarm</strong> 模式下利用 <strong>compose-file</strong> 管理服务</td></tr></tbody></table></div><p><strong>说明：</strong></p><p>其中 <strong>container</strong> 、<strong>image</strong> 、<strong>system</strong> 一般用前面的简化指令即可。<strong>Swarm</strong> 模式用来管理 <strong>Docker</strong> 集群, 它将一群 <strong>Docker</strong> 宿主机变成一个单一的虚拟的主机, 实现对多台物理机的集群管理。</p><h2 id="Docker空间扩容"><a href="#Docker空间扩容" class="headerlink" title="Docker空间扩容"></a>Docker空间扩容</h2><p>docker默认是把数据（images、containers等）保存在<code>/var/lib/docker</code>中，有的人根目录空间很有限，想给docker扩容，怎么办呢：</p><p>一种办法是先停止docker daemon，然后把上述目录移动到/opt/data或者其他的有空间的目录下，最后在/var/lib下做个同名的docker软连接，指向/opt/data/docker：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">service docker stop（或者/etc/init.d/docker stop）</span><br><span class="line"></span><br><span class="line">mv /var/lib/docker /opt/data</span><br><span class="line">ln -s /opt/data/docker /var/lib/docker</span><br><span class="line"></span><br><span class="line">service docker start</span><br></pre></td></tr></table></figure><p>若遇到<code>/var/lib/docker</code>无法删除时，可以参考<a href="https://github.com/moby/moby/issues/6077。" target="_blank" rel="noopener">https://github.com/moby/moby/issues/6077。</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/mounts |grep docker</span><br><span class="line">sudo umount /path</span><br></pre></td></tr></table></figure><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://www.jianshu.com/p/7c9e2247cfbd" target="_blank" rel="noopener">Docker 常用指令详解</a><br><a href="https://yeasy.gitbooks.io/docker_practice/image/pull.html" target="_blank" rel="noopener">获取镜像</a><br><a href="https://stackoverflow.com/a/54543280" target="_blank" rel="noopener">Can’t install pip packages inside a docker container with Ubuntu</a><br><a href="https://blog.csdn.net/tang_jin2015/article/details/78898780" target="_blank" rel="noopener">删除镜像</a><br><a href="https://blog.csdn.net/renzhewudi77/article/details/82858280" target="_blank" rel="noopener">如何解决 image has dependent child images 错误</a><br><a href="https://developer.aliyun.com/ask/134087" target="_blank" rel="noopener">怎么在 docker 中开启多个终端</a><br> <a href="https://blog.windrunner.me/programming/jupyter-docker.html" target="_blank" rel="noopener">在 docker 中运行 Jupyter notebook</a><br><a href="https://stackoverflow.com/questions/40622162/docker-load-and-save-archive-tar-invalid-tar-header" target="_blank" rel="noopener">Docker load and save: “archive/tar: invalid tar header”</a><br><a href="https://github.com/ultralytics/yolov3/issues/283#issuecomment-552776535" target="_blank" rel="noopener">ERROR: Unexpected bus error encountered in worker. This might be caused by insufficient shared memory (shm). #283</a><br><a href="https://github.com/moby/moby/issues/6077" target="_blank" rel="noopener">Cannot remove /var/lib/docker after changing docker runtime root to /home/docker after a fresh install with no containers / images #6077</a><br><a href="https://blog.csdn.net/lgfun/article/details/102585769" target="_blank" rel="noopener">给docker扩容、删除/var/lib/docker</a></p></div><div><div style="text-align:center;color:#ccc;font-size:14px">------ 本文结束------</div></div><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'> 打赏</button><div id="qr" style="display:none"><div style="display:inline-block"> <img src="/uploads/wechat.png" alt="zdaiot 微信支付"><p>微信支付</p></div><div style="display:inline-block"> <img src="/uploads/aipay.jpg" alt="zdaiot 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> zdaiot</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/" title="Docker常用指令详解">https://www.zdaiot.com/Tools/Docker/Docker常用指令详解/</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/uploads/wechat-qcode.jpg"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">WeChat</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Docker/" rel="tag"><i class="fa fa-tag"></i> Docker</a></div><div class="post-nav"><div class="post-nav-item"><a href="/Tools/Docker/Docker简介/" rel="prev" title="Docker简介"><i class="fa fa-chevron-left"></i> Docker简介</a></div><div class="post-nav-item"> <a href="/DataStructureAlgorithm/07栈：如何实现浏览器的前进和后退功能/" rel="next" title="07栈：如何实现浏览器的前进和后退功能">07栈：如何实现浏览器的前进和后退功能<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概览"><span class="nav-number">1.</span> <span class="nav-text">概览</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#镜像仓库相关"><span class="nav-number">2.</span> <span class="nav-text">镜像仓库相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查找镜像"><span class="nav-number">2.1.</span> <span class="nav-text">查找镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取镜像"><span class="nav-number">2.2.</span> <span class="nav-text">获取镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#推送镜像到仓库"><span class="nav-number">2.3.</span> <span class="nav-text">推送镜像到仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#登录-退出第三方仓库"><span class="nav-number">2.4.</span> <span class="nav-text">登录/退出第三方仓库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#本地镜像"><span class="nav-number">3.</span> <span class="nav-text">本地镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查看本地镜像"><span class="nav-number">3.1.</span> <span class="nav-text">查看本地镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除本地镜像"><span class="nav-number">3.2.</span> <span class="nav-text">删除本地镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看镜像详情"><span class="nav-number">3.3.</span> <span class="nav-text">查看镜像详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#打包本地镜像-使用压缩包来完成迁移"><span class="nav-number">3.4.</span> <span class="nav-text">打包本地镜像, 使用压缩包来完成迁移</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#导入镜像压缩包"><span class="nav-number">3.5.</span> <span class="nav-text">导入镜像压缩包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改镜像tag"><span class="nav-number">3.6.</span> <span class="nav-text">修改镜像tag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#容器相关"><span class="nav-number">4.</span> <span class="nav-text">容器相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#创建、启动容器并执行相应的命令"><span class="nav-number">4.1.</span> <span class="nav-text">创建、启动容器并执行相应的命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看运行中的容器"><span class="nav-number">4.2.</span> <span class="nav-text">查看运行中的容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开启-停止-重启容器"><span class="nav-number">4.3.</span> <span class="nav-text">开启/停止/重启容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除容器"><span class="nav-number">4.4.</span> <span class="nav-text">删除容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看容器详情"><span class="nav-number">4.5.</span> <span class="nav-text">查看容器详情</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查看容器中正在运行的进程"><span class="nav-number">4.6.</span> <span class="nav-text">查看容器中正在运行的进程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#保存容器"><span class="nav-number">4.7.</span> <span class="nav-text">保存容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#开启新终端进入同一个docker"><span class="nav-number">4.8.</span> <span class="nav-text">开启新终端进入同一个docker</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用-Dockerfile-构建镜像"><span class="nav-number">4.9.</span> <span class="nav-text">使用 Dockerfile 构建镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#映射jupyter-notebook"><span class="nav-number">4.10.</span> <span class="nav-text">映射jupyter-notebook</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#硬件资源相关"><span class="nav-number">5.</span> <span class="nav-text">硬件资源相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#显示容器硬件资源使用情况"><span class="nav-number">5.1.</span> <span class="nav-text">显示容器硬件资源使用情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#更新容器的硬件资源限制"><span class="nav-number">5.2.</span> <span class="nav-text">更新容器的硬件资源限制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用压力测试工具-stress-验证效果"><span class="nav-number">5.3.</span> <span class="nav-text">使用压力测试工具 stress 验证效果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基础子命令列表"><span class="nav-number">6.</span> <span class="nav-text">基础子命令列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用于管理的子命令列表"><span class="nav-number">7.</span> <span class="nav-text">用于管理的子命令列表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker空间扩容"><span class="nav-number">8.</span> <span class="nav-text">Docker空间扩容</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">9.</span> <span class="nav-text">参考</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="zdaiot" src="/uploads/avatar.png"><p class="site-author-name" itemprop="name">zdaiot</p><div class="site-description" itemprop="description">404NotFound</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">313</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">53</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">369</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/zdaiot" title="GitHub → https://github.com/zdaiot" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:zdaiot@163.com" title="E-Mail → mailto:zdaiot@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/" title="知乎 → https://www.zhihu.com/people/" rel="noopener" target="_blank"><i class="fa fa-book fa-fw"></i> 知乎</a></span><span class="links-of-author-item"><a href="https://blog.csdn.net/zdaiot" title="CSDN → https://blog.csdn.net/zdaiot" rel="noopener" target="_blank"><i class="fa fa-copyright fa-fw"></i> CSDN</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="https://kalacloud.com" title="https://kalacloud.com" rel="noopener" target="_blank">卡拉云低代码工具</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="https://beian.miit.gov.cn" rel="noopener" target="_blank">京ICP备2021031914号</a></div><div class="copyright"> &copy; <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">zdaiot</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-chart-area"></i></span> <span title="站点总字数">2.1m</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span title="站点阅读时长">31:16</span></div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b5e7e498f94b7ad" async="async"></script></div> <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("08/01/2018 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="Run for "+dnum+" Days ",document.getElementById("times").innerHTML=hnum+" Hours "+mnum+" m "+snum+" s"}setInterval("createtime()",250)</script><div class="busuanzi-count"><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span> <span class="post-meta-divider">|</span><span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script><script data-pjax>!function(){var o,n,e=document.getElementsByTagName("link");if(0<e.length)for(i=0;i<e.length;i++)"canonical"==e[i].rel.toLowerCase()&&e[i].href&&(o=e[i].href);n=o?o.split(":")[0]:window.location.protocol.split(":")[0],o||(o=window.location.href),function(){var e=o,i=document.referrer;if(!/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi.test(e)){var t="https"===String(n).toLowerCase()?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";i?(t+="?r="+encodeURIComponent(document.referrer),e&&(t+="&l="+e)):e&&(t+="?l="+e),(new Image).src=t}}(window)}()</script><script src="/js/local-search.js"></script><div id="pjax"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '4800250e682fe873198b',
      clientSecret: '80f7f33f5f8ddfd3944f455cabadda4ff3299147',
      repo        : 'zdaiot.github.io',
      owner       : 'zdaiot',
      admin       : ['zdaiot'],
      id          : 'a337e847c3bc29b4ff3de39f01b380b7',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/wanko.model.json"},display:{position:"left",width:150,height:300},mobile:{show:!0}})</script></body></html>